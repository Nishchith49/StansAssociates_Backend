import{A as z,b as k,d as h,e as L,f as w,g as E,h as _,i as N,j as te,k as y,n as T,o as oe,p as A,q as B,s as ie,t as ne,v as V}from"./chunk-L7HYSWOG.js";import{c as re,e as G,i as ae,j as se}from"./chunk-SMNPRYKW.js";import{c as de,g as le}from"./chunk-FDP5VDWE.js";import"./chunk-LCCYGYQT.js";import{Aa as l,Ba as c,Bb as O,Ca as H,Da as $,Ea as U,Fa as u,Ga as o,Ha as i,Ia as f,Nb as ee,O as C,Oa as W,P as v,Pb as M,Qa as g,Qb as F,Sa as m,Tb as I,Ub as D,a as J,ab as a,b as K,bb as x,cb as S,eb as X,gb as Y,ha as s,la as p,oa as P,ta as Q,u as j,xb as Z}from"./chunk-M53X7M2I.js";var _e=["class","component"],Ce=()=>[10,20,30,50];function ve(n,t){n&1&&(o(0,"div",10),f(1,"app-loading-page"),i())}function be(n,t){if(n&1&&(o(0,"div",11),f(1,"app-error-page",14),i()),n&2){let e=m();s(),u("errorData",e.errorData)}}function Se(n,t){if(n&1){let e=W();o(0,"tr")(1,"td"),a(2),i(),o(3,"td"),a(4),i(),o(5,"td"),a(6),i(),o(7,"td"),a(8),i(),o(9,"td")(10,"button",16),g("click",function(){let d=C(e).$implicit,b=m(2);return v(b.editDetails(d.id))}),a(11," Edit "),i(),o(12,"button",17),g("click",function(){let d=C(e).$implicit,b=m(2);return v(b.delete(d))}),a(13," Delete "),i()()()}if(n&2){let e=t.$implicit,r=t.$index;s(2),x(r+1),s(2),x(e.boardingPoint),s(2),x(e.busNo),s(2),x(e.routeCost)}}function xe(n,t){if(n&1&&(o(0,"div",12)(1,"table",15)(2,"thead")(3,"tr")(4,"th"),a(5,"Sl.No"),i(),o(6,"th"),a(7,"Boarding Point"),i(),o(8,"th"),a(9,"Bus No"),i(),o(10,"th"),a(11,"Cost"),i(),o(12,"th"),a(13,"Actions"),i()()(),o(14,"tbody"),$(15,Se,14,4,"tr",null,H),i()()()),n&2){let e=m();s(15),U(e.routes)}}function Ee(n,t){if(n&1&&(o(0,"option",20),a(1),i()),n&2){let e=t.$implicit;u("value",e),s(),S(" ",e," ")}}function Re(n,t){if(n&1){let e=W();o(0,"div",13)(1,"div",18)(2,"label"),a(3,"Items per page:"),i(),o(4,"select",19),g("change",function(d){C(e);let b=m();return v(b.onPageSizeChange(d))}),$(5,Ee,2,2,"option",20,H),i(),o(7,"span"),a(8),i(),o(9,"button",21),g("click",function(){C(e);let d=m();return v(d.goToFirstPage())}),a(10," \xAB "),i(),o(11,"button",21),g("click",function(){C(e);let d=m();return v(d.goToPreviousPage())}),a(12," \u2039 "),i(),o(13,"button",21),g("click",function(){C(e);let d=m();return v(d.goToNextPage())}),a(14," \u203A "),i(),o(15,"button",21),g("click",function(){C(e);let d=m();return v(d.goToLastPage())}),a(16," \xBB "),i()()()}if(n&2){let e=m();s(4),u("value",e.pageSize),s(),U(Y(8,Ce)),s(3),X("",e.pageNumber*e.pageSize+1," - ",e.getEndItemIndex()," of ",e.totalRecords),s(),u("disabled",e.pageNumber===0),s(2),u("disabled",e.pageNumber===0),s(2),u("disabled",e.pageNumber+1>=e.totalPages),s(2),u("disabled",e.pageNumber+1>=e.totalPages)}}var q=class n{constructor(t,e,r,d,b){this._routeService=t;this._authService=e;this._router=r;this._snackBar=d;this._dialog=b}paginatorForm=new E({pageNumber:new _(0),pageSize:new _(10)});filterForm=new E({searchString:new _(null)});isLoading=!1;isLoadingData=!0;isError=!1;errorData;totalRecords=0;routes=[];ngOnInit(){this.getRoutesData(),this.paginatorForm.valueChanges.pipe(j(500)).subscribe(t=>{this.isLoadingData=!0,this.getRoutesData()}),this.filterForm.valueChanges.pipe(j(500)).subscribe(t=>{this.isLoadingData=!0,this.getRoutesData()})}get pageNumber(){return this.paginatorForm.get("pageNumber")?.value??0}get pageSize(){return this.paginatorForm.get("pageSize")?.value??10}get totalPages(){return Math.ceil(this.totalRecords/this.pageSize)}getEndItemIndex(){let t=(this.pageNumber+1)*this.pageSize;return t>this.totalRecords?this.totalRecords:t}goToFirstPage(){this.paginatorForm.patchValue({pageNumber:0})}goToPreviousPage(){this.pageNumber>0&&this.paginatorForm.patchValue({pageNumber:this.pageNumber-1})}goToNextPage(){this.pageNumber+1<this.totalPages&&this.paginatorForm.patchValue({pageNumber:this.pageNumber+1})}goToLastPage(){this.paginatorForm.patchValue({pageNumber:this.totalPages-1})}onPageSizeChange(t){let e=parseInt(t.target.value,10);this.paginatorForm.patchValue({pageSize:e,pageNumber:0})}getRoutesData(){let t={pageIndex:this.pageNumber,pageSize:this.pageSize,searchString:this.filterForm.value.searchString||""};this.isError=!1,this.errorData=null,this.isLoadingData=!0,this._routeService.apiRouteGetRoutesPost(t).subscribe({next:e=>{this.isLoadingData=!1,e.statusCode===200&&e.data?(this.isError=!1,this.routes=e.data,this.totalRecords=e.totalRecords??0):(this.isError=!0,this.errorData={imgSrc:"empty-box.png",errorTitleMessage:"No Data available",errorSubTitleMessage:"Please try to add Routes!"})},error:e=>{this.isLoadingData=!1,this.routes=[],navigator.onLine?e.status===401?this._authService.logout():this.setGenericError():this.errorData={imgSrc:"no-signal.png",errorTitleMessage:"Internet connection lost",errorSubTitleMessage:"Please check your connection."},this.isError=!0}})}setGenericError(){this.errorData={imgSrc:"error.png",errorTitleMessage:"Something went wrong",errorSubTitleMessage:"Please try again later"}}resetToSearch(){this.filterForm.controls.searchString.reset()}editDetails(t){this._router.navigate(["/admin/routes/edit"],{queryParams:{routeId:t}})}delete(t){this._dialog.open(le,{width:"400px",data:{title:"Confirm",content:`Are you sure, Do you want to delete - ${t?.boardingPoint}?`}}).afterClosed().subscribe(r=>{r==!0&&(this.isLoadingData=!0,this._routeService.apiRouteDeleteRouteDelete(t?.id).subscribe({next:d=>{this.isLoadingData=!1,d.statusCode==200?(this.getRoutesData(),this._snackBar.open("Route deleted successfully","Close",{duration:3e3,panelClass:["snack-error"]})):this._snackBar.open(d.message??"Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]})},error:d=>{this.isLoadingData=!1,navigator.onLine?d.status===401?this._authService.logout():this.setGenericError():this.errorData={imgSrc:"no-signal.png",errorTitleMessage:"Internet connection lost",errorSubTitleMessage:"Please check your connection."},this.isError=!0}}))})}static \u0275fac=function(e){return new(e||n)(p(G),p(D),p(M),p(z),p(de))};static \u0275cmp=P({type:n,selectors:[["app-list",8,"component"]],attrs:_e,decls:22,vars:5,consts:[[1,"main-container"],[1,"header"],[1,"header-left"],[1,"page-title"],[1,"breadcrumb"],["routerLink","/admin/dashboard"],[1,"separator"],[1,"header-right",3,"formGroup"],["type","text","placeholder","Search...","formControlName","searchString",1,"search-input"],["routerLink","/admin/routes/add",1,"add-button"],["fxLayoutAlign","center center",1,"loading-page-ui"],[1,"error-page-ui"],[1,"table-wrapper"],[1,"paginator-wrapper"],[3,"errorData"],[1,"table-ui"],[1,"edit-button",3,"click"],[1,"delete-button",3,"click"],[1,"pagination-controls"],[3,"change","value"],[3,"value"],[3,"click","disabled"]],template:function(e,r){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),a(5,"Routes"),i()(),o(6,"div",4)(7,"span")(8,"a",5),a(9,"Home"),i()(),o(10,"span",6),a(11,"/"),i(),o(12,"span"),a(13,"Routes"),i()()(),o(14,"form",7),f(15,"input",8),o(16,"button",9),a(17,"Add"),i()()(),l(18,ve,2,0,"div",10),l(19,be,2,1,"div",11),l(20,xe,17,0,"div",12),l(21,Re,17,9,"div",13),i()),e&2&&(s(14),u("formGroup",r.filterForm),s(4),c(r.isLoadingData&&!r.isError?18:-1),s(),c(!r.isLoadingData&&r.isError?19:-1),s(),c(!r.isLoadingData&&!r.isError?20:-1),s(),c(r.totalRecords>r.pageSize?21:-1))},dependencies:[I,F,O,se,V,N,A,B,k,L,w,y,T,ae],encapsulation:2})};var Pe=["class","component"];function Oe(n,t){if(n&1&&(o(0,"option",28),a(1),i()),n&2){let e=t.$implicit;u("value",e.value),s(),S(" ",e.label," ")}}function Me(n,t){n&1&&(o(0,"span"),a(1,"School is required"),i())}function Fe(n,t){if(n&1&&(o(0,"div",18),l(1,Me,2,0,"span"),i()),n&2){let e=m();s(),c(e.addOrEditRouteForm.controls.schoolId.errors!=null&&e.addOrEditRouteForm.controls.schoolId.errors.required||e.addOrEditRouteForm.controls.schoolId.errors!=null&&e.addOrEditRouteForm.controls.schoolId.errors.min?1:-1)}}function Ie(n,t){n&1&&(o(0,"span"),a(1,"Boarding point is required"),i())}function De(n,t){n&1&&(o(0,"span"),a(1,"Aleast 3 characters required"),i())}function ke(n,t){n&1&&(o(0,"span"),a(1,"Almost 60 characters"),i())}function Le(n,t){if(n&1&&(o(0,"div",18),l(1,Ie,2,0,"span"),l(2,De,2,0,"span"),l(3,ke,2,0,"span"),i()),n&2){let e=m();s(),c(e.addOrEditRouteForm.controls.boardingPoint.errors!=null&&e.addOrEditRouteForm.controls.boardingPoint.errors.required?1:-1),s(),c(e.addOrEditRouteForm.controls.boardingPoint.errors!=null&&e.addOrEditRouteForm.controls.boardingPoint.errors.minlength?2:-1),s(),c(e.addOrEditRouteForm.controls.boardingPoint.errors!=null&&e.addOrEditRouteForm.controls.boardingPoint.errors.maxlength?3:-1)}}function we(n,t){n&1&&(o(0,"span"),a(1,"Bus number is required"),i())}function Ne(n,t){if(n&1&&(o(0,"div",18),l(1,we,2,0,"span"),i()),n&2){let e=m();s(),c(e.addOrEditRouteForm.controls.busNo.errors!=null&&e.addOrEditRouteForm.controls.busNo.errors.required?1:-1)}}function ye(n,t){n&1&&(o(0,"span"),a(1,"Transportation fee is required"),i())}function Te(n,t){n&1&&(o(0,"span"),a(1,"Atleast 0"),i())}function Ae(n,t){if(n&1&&(o(0,"div",18),l(1,ye,2,0,"span"),l(2,Te,2,0,"span"),i()),n&2){let e=m();s(),c(e.addOrEditRouteForm.controls.routeCost.errors!=null&&e.addOrEditRouteForm.controls.routeCost.errors.required?1:-1),s(),c(e.addOrEditRouteForm.controls.routeCost.errors!=null&&e.addOrEditRouteForm.controls.routeCost.errors.min?2:-1)}}function Be(n,t){n&1&&f(0,"span",27)}var R=class n{constructor(t,e,r,d,b,Ve){this._routeService=t;this._dropDownService=e;this._route=r;this._router=d;this._authenticationService=b;this._snackBar=Ve}addOrEditRouteForm=new E({schoolId:new _(0,[h.required,h.min(1)]),busNo:new _("",h.required),boardingPoint:new _("",[h.required,h.minLength(3),h.maxLength(60)]),routeCost:new _(0,[h.required,h.min(0)])});schools=[];isLoading=!1;routeId;isLoadingData=!1;isError=!1;errorData;ngOnInit(){this._dropDownService.apiDropDownGetSchoolDropDownGet().subscribe({next:t=>{this.schools=t?.map(e=>K(J({},e),{value:Number(e.value)}))??[]},error:()=>{this._snackBar.open("Failed to load schools","Close",{duration:3e3})}}),this.routeId=Number(this._route.snapshot.queryParamMap.get("routeId")),this.routeId&&(this.isLoadingData=!0,this._routeService.apiRouteGetRouteGet(this.routeId).subscribe({next:t=>{this.isLoadingData=!1,t.statusCode===200&&t.data?this.addOrEditRouteForm.patchValue(t.data):(this.isError=!0,this.errorData={imgSrc:"../../../../../assets/images/icons/error.png",errorTitleMessage:"Something went wrong",errorSubTitleMessage:"Please try after sometime!"})},error:t=>{this.isLoadingData=!1,this.isError=!0,navigator.onLine?t.status==401?this._authenticationService.logout():this.errorData={imgSrc:"../../../../../assets/images/icons/error.png",errorTitleMessage:"Something went wrong",errorSubTitleMessage:"Please try after sometime!"}:this.errorData={imgSrc:"../../../../../assets/images/icons/no-signal.png",errorTitleMessage:"Internet connection lost",errorSubTitleMessage:"Please check your internet connection!"}}}))}onSubmit(){let t=this.addOrEditRouteForm.value;if(this.routeId)if(this.addOrEditRouteForm.valid){let e={schoolId:t.schoolId??0,busNo:t.busNo??"",boardingPoint:t.boardingPoint??"",routeCost:t.routeCost??0,id:this.routeId??""};this.isLoading=!0,this.addOrEditRouteForm.disable(),this._routeService.apiRouteUpdateRoutePost(e).subscribe({next:r=>{this.isLoading=!1,this.addOrEditRouteForm.enable(),r.statusCode===200?(this._router.navigateByUrl("/admin/routes/list"),this._snackBar.open(r.message??"Route updated successfully","Close",{duration:3e3,panelClass:["snack-success"]})):this._snackBar.open(r.message??"Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]})},error:r=>{this.isLoading=!1,this.addOrEditRouteForm.enable(),navigator.onLine?this._snackBar.open("Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]}):r.status==401?this._authenticationService.logout():this._snackBar.open("Internet Connection Lost, Please check your connectivity","Close",{duration:3e3,panelClass:["snack-error"]})}})}else{this._snackBar.open("Please enter route","Close",{duration:3e3,panelClass:["snack-error"]}),this.addOrEditRouteForm.markAllAsTouched();return}else if(this.addOrEditRouteForm.valid){let e={schoolId:t.schoolId??0,busNo:t.busNo??"",boardingPoint:t.boardingPoint??"",routeCost:t.routeCost??0};this.isLoading=!0,this.addOrEditRouteForm.disable(),this._routeService.apiRouteAddRoutePost(e).subscribe({next:r=>{this.isLoading=!1,this.addOrEditRouteForm.enable(),r.statusCode===200?(this._router.navigateByUrl("/admin/routes/list"),this._snackBar.open(r.message??"Route created successfully","Close",{duration:3e3,panelClass:["snack-success"]})):this._snackBar.open(r.message??"Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]})},error:r=>{this.isLoading=!1,this.addOrEditRouteForm.enable(),navigator.onLine?this._snackBar.open("Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]}):r.status==401?this._authenticationService.logout():this._snackBar.open("Internet Connection Lost, Please check your connectivity","Close",{duration:3e3,panelClass:["snack-error"]})}})}else{this._snackBar.open("Please enter route details","Close",{duration:3e3,panelClass:["snack-error"]}),this.addOrEditRouteForm.markAllAsTouched();return}}static \u0275fac=function(e){return new(e||n)(p(G),p(re),p(ee),p(M),p(D),p(z))};static \u0275cmp=P({type:n,selectors:[["app-add-or-edit",8,"component"]],attrs:Pe,decls:58,vars:11,consts:[[1,"main-container"],[1,"header"],[1,"header-left"],[1,"page-title"],[1,"breadcrumb"],["routerLink","/admin/dashboard"],[1,"separator"],["routerLink","/admin/routes/list"],[1,"form-container"],[3,"ngSubmit","formGroup"],[1,"form-body"],[1,"basic-container"],[1,"form-row"],[1,"form-group"],["for","schoolId"],[1,"text-warn"],["formControlName","schoolId","id","schoolId",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"error"],["for","boardingPoint"],["type","text","formControlName","boardingPoint","id","boardingPoint"],["for","busNo"],["type","text","formControlName","busNo","id","busNo"],["for","routeCost"],["type","number","formControlName","routeCost","id","routeCost","oninput","this.value = this.value.replace(/[^0-9]/g, '');","maxlength","10","minlength","10","autocomplete","off","aria-label","Route Cost"],[1,"form-actions"],["type","submit",1,"submit",3,"disabled"],[1,"spinner"],[3,"value"]],template:function(e,r){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),a(5),i()(),o(6,"div",4)(7,"span")(8,"a",5),a(9,"Home"),i()(),o(10,"span",6),a(11,"/"),i(),o(12,"span")(13,"a",7),a(14,"Routes"),i()(),o(15,"span",6),a(16,"/"),i(),o(17,"span"),a(18),i()()()(),o(19,"div",8)(20,"form",9),g("ngSubmit",function(){return r.onSubmit()}),o(21,"div",10)(22,"div",11)(23,"div",12)(24,"div",13)(25,"label",14),a(26,"Select School"),o(27,"span",15),a(28,"*"),i()(),o(29,"select",16),Q(30,Oe,2,2,"option",17),i(),l(31,Fe,2,1,"div",18),i(),o(32,"div",13)(33,"label",19),a(34,"Boarding Point"),o(35,"span",15),a(36,"*"),i()(),f(37,"input",20),l(38,Le,4,3,"div",18),i()(),o(39,"div",12)(40,"div",13)(41,"label",21),a(42,"Bus Number"),o(43,"span",15),a(44,"*"),i()(),f(45,"input",22),l(46,Ne,2,1,"div",18),i(),o(47,"div",13)(48,"label",23),a(49,"Transportation Fee"),o(50,"span",15),a(51,"*"),i()(),f(52,"input",24),l(53,Ae,3,2,"div",18),i()()()(),o(54,"div",25)(55,"button",26),l(56,Be,1,0,"span",27),a(57),i()()()()()),e&2&&(s(5),S("",r.routeId?"Edit":"Add"," Route"),s(13),S("",r.routeId?"Edit":"Add"," Routes"),s(2),u("formGroup",r.addOrEditRouteForm),s(10),u("ngForOf",r.schools),s(),c(r.addOrEditRouteForm.controls.schoolId.touched&&r.addOrEditRouteForm.controls.schoolId.invalid?31:-1),s(7),c(r.addOrEditRouteForm.controls.boardingPoint.touched&&r.addOrEditRouteForm.controls.boardingPoint.invalid?38:-1),s(8),c(r.addOrEditRouteForm.controls.busNo.touched&&r.addOrEditRouteForm.controls.busNo.invalid?46:-1),s(7),c(r.addOrEditRouteForm.controls.routeCost.touched&&r.addOrEditRouteForm.controls.routeCost.invalid?53:-1),s(2),u("disabled",r.isLoading),s(),c(r.isLoading?56:-1),s(),S(" ",r.isLoading?"Submitting...":"Submit"," "))},dependencies:[I,F,V,N,A,B,k,te,oe,L,w,ie,ne,y,T,O,Z],styles:[".form[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{display:flex}.form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:20px;margin-right:30px;width:100%}.form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;margin-bottom:5px;font-weight:500;color:#333}.form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .text-warn[_ngcontent-%COMP%]{color:red;margin-left:4px}.form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{width:100%;padding:8px 10px;font-size:.95rem;border-radius:4px;box-sizing:border-box;border:1px solid #ccc;transition:border-color .2s ease-in-out}.form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff}.form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:8px 10px;font-size:.95rem;border-radius:4px;box-sizing:border-box;border:1px solid #ccc;transition:border-color .2s ease-in-out}.form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff}.form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;margin-top:5px;font-size:.85rem;color:red}.form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{text-align:right;margin-top:10px}.form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:6px 14px;font-size:.95rem;border-radius:4px;border:none;background-color:#007bff;color:#fff;cursor:pointer;transition:background-color .2s ease}.form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}"]})};var at=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:q},{path:"add",component:R},{path:"edit",component:R}];export{at as routesRoutes};
