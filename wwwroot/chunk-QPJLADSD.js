import{a as le}from"./chunk-J35TZ3AM.js";import{a as se}from"./chunk-ABOBCSHE.js";import{A as U,b as k,d as p,e as R,f as V,g as y,h as _,i as G,k as q,n as B,o as te,p as z,q as H,s as ie,t as oe,v as $}from"./chunk-L7HYSWOG.js";import{c as ne,f as j,i as re,j as ae}from"./chunk-QFFBEC2S.js";import{c as Z,g as de}from"./chunk-FDP5VDWE.js";import"./chunk-LCCYGYQT.js";import{Aa as d,Ba as s,Bb as T,Ca as x,Da as w,Ea as b,Fa as u,Ga as o,Ha as n,Ia as h,Ma as X,Na as K,Nb as ee,O as E,Oa as I,P as C,Pb as A,Qa as S,Qb as N,Sa as m,Tb as L,Ub as M,ab as a,bb as O,cb as v,ea as D,eb as Q,gb as Y,ha as l,la as g,oa as P,u as W}from"./chunk-M53X7M2I.js";var Ee=["class","component"],Ce=()=>[10,20,30,50];function ve(i,t){i&1&&(o(0,"div",10),h(1,"app-loading-page"),n())}function xe(i,t){if(i&1&&(o(0,"div",11),h(1,"app-error-page",12),n()),i&2){let e=m();l(),u("errorData",e.errorData)}}function we(i,t){if(i&1){let e=I();o(0,"tr")(1,"td"),a(2),n(),o(3,"td")(4,"img",19),S("error",function(c){E(e);let f=m(2);return C(f.handleImageError(c))}),n()(),o(5,"td"),a(6),n(),o(7,"td"),a(8),n(),o(9,"td"),a(10),n(),o(11,"td"),a(12),n(),o(13,"td")(14,"button",20),S("click",function(){let c=E(e).$implicit,f=m(2);return C(f.editSchoolDetails(c.id))}),a(15," Edit "),n(),o(16,"button",21),S("click",function(){let c=E(e).$implicit,f=m(2);return C(f.deleteSchool(c))}),a(17," Delete "),n()()()}if(i&2){let e=t.$implicit,r=t.$index;l(2),O(r+1),l(2),u("src",`data:image/png;base64,${e.profilePicture}`,D),l(2),O(e.name),l(2),O(e.emailId),l(2),O(e.phoneNumber),l(2),O(e.cityName)}}function be(i,t){if(i&1&&(o(0,"option",24),a(1),n()),i&2){let e=t.$implicit;u("value",e),l(),v(" ",e," ")}}function Ie(i,t){if(i&1){let e=I();o(0,"div",15)(1,"div",22)(2,"label"),a(3,"Items per page:"),n(),o(4,"select",23),S("change",function(c){E(e);let f=m(2);return C(f.onPageSizeChange(c))}),w(5,be,2,2,"option",24,x),n(),o(7,"span"),a(8),n(),o(9,"button",25),S("click",function(){E(e);let c=m(2);return C(c.goToFirstPage())}),a(10," \xAB "),n(),o(11,"button",25),S("click",function(){E(e);let c=m(2);return C(c.goToPreviousPage())}),a(12," \u2039 "),n(),o(13,"button",25),S("click",function(){E(e);let c=m(2);return C(c.goToNextPage())}),a(14," \u203A "),n(),o(15,"button",25),S("click",function(){E(e);let c=m(2);return C(c.goToLastPage())}),a(16," \xBB "),n()()()}if(i&2){let e=m(2);l(4),u("value",e.pageSize),l(),b(Y(8,Ce)),l(3),Q("",e.pageNumber*e.pageSize+1," - ",e.getEndItemIndex()," of ",e.totalRecords),l(),u("disabled",e.pageNumber===0),l(2),u("disabled",e.pageNumber===0),l(2),u("disabled",e.pageNumber+1>=e.totalPages),l(2),u("disabled",e.pageNumber+1>=e.totalPages)}}function Oe(i,t){i&1&&h(0,"span",18)}function ye(i,t){if(i&1){let e=I();o(0,"div",13)(1,"table",14)(2,"thead")(3,"tr")(4,"th"),a(5,"Sl.No"),n(),o(6,"th"),a(7,"Profile Image"),n(),o(8,"th"),a(9,"Name"),n(),o(10,"th"),a(11,"Email Id"),n(),o(12,"th"),a(13,"Phone Number"),n(),o(14,"th"),a(15,"City"),n(),o(16,"th"),a(17,"Actions"),n()()(),o(18,"tbody"),w(19,we,18,6,"tr",null,x),n()()(),d(21,Ie,17,9,"div",15),o(22,"div",16)(23,"button",17),S("click",function(){E(e);let c=m();return C(c.exportExcel())}),d(24,Oe,1,0,"span",18),a(25),n()()}if(i&2){let e=m();l(19),b(e.schools),l(2),s(e.totalRecords>e.pageSize?21:-1),l(2),u("disabled",e.isExportingExcelData),l(),s(e.isExportingExcelData?24:-1),l(),v(" ",e.isExportingExcelData?"Exporting...":"Export Excel"," ")}}var J=class i{constructor(t,e,r,c,f,ce){this._schoolService=t;this._authService=e;this._router=r;this._snackBar=c;this._dialog=f;this._generateExcelService=ce}paginatorForm=new y({pageNumber:new _(0),pageSize:new _(10)});filterForm=new y({searchString:new _(null)});isLoading=!1;isLoadingData=!0;isError=!1;errorData;totalRecords=0;schools=[];ngOnInit(){this.getSchoolsData(),this.paginatorForm.valueChanges.pipe(W(500)).subscribe(t=>{this.isLoadingData=!0,this.getSchoolsData()}),this.filterForm.valueChanges.pipe(W(500)).subscribe(t=>{this.isLoadingData=!0,this.getSchoolsData()})}get pageNumber(){return this.paginatorForm.get("pageNumber")?.value??0}get pageSize(){return this.paginatorForm.get("pageSize")?.value??10}get totalPages(){return Math.ceil(this.totalRecords/this.pageSize)}getEndItemIndex(){let t=(this.pageNumber+1)*this.pageSize;return t>this.totalRecords?this.totalRecords:t}goToFirstPage(){this.paginatorForm.patchValue({pageNumber:0})}goToPreviousPage(){this.pageNumber>0&&this.paginatorForm.patchValue({pageNumber:this.pageNumber-1})}goToNextPage(){this.pageNumber+1<this.totalPages&&this.paginatorForm.patchValue({pageNumber:this.pageNumber+1})}goToLastPage(){this.paginatorForm.patchValue({pageNumber:this.totalPages-1})}onPageSizeChange(t){let e=parseInt(t.target.value,10);this.paginatorForm.patchValue({pageSize:e,pageNumber:0})}getSchoolsData(){let t={pageIndex:this.pageNumber,pageSize:this.pageSize,searchString:this.filterForm.value.searchString||""};this.isError=!1,this.errorData=null,this.isLoadingData=!0,this._schoolService.apiSchoolGetSchoolsPost(t).subscribe({next:e=>{this.isLoadingData=!1,e.statusCode===200&&e.data?(this.isError=!1,this.schools=e.data,this.totalRecords=e.totalRecords??0):(this.isError=!0,this.errorData={imgSrc:"empty-box.png",errorTitleMessage:"No Data available",errorSubTitleMessage:"Please try to add Schools!"})},error:e=>{this.isLoadingData=!1,this.schools=[],navigator.onLine?e.status===401?this._authService.logout():this.setGenericError():this.errorData={imgSrc:"no-signal.png",errorTitleMessage:"Internet connection lost",errorSubTitleMessage:"Please check your connection."},this.isError=!0}})}setGenericError(){this.errorData={imgSrc:"error.png",errorTitleMessage:"Something went wrong",errorSubTitleMessage:"Please try again later"}}resetToSearch(){this.filterForm.controls.searchString.reset()}editSchoolDetails(t){this._router.navigate(["/admin/schools/edit"],{queryParams:{schoolId:t}})}deleteSchool(t){this._dialog.open(de,{width:"400px",data:{title:"Confirm",content:`Are you sure, Do you want to delete - ${t?.name}?`}}).afterClosed().subscribe(r=>{r==!0&&(this.isLoadingData=!0,this._schoolService.apiSchoolDeleteSchoolDelete(t.id).subscribe({next:c=>{this.isLoadingData=!1,c.statusCode==200?(this.getSchoolsData(),this._snackBar.open("School deleted successfully","Close",{duration:3e3,panelClass:[".snack-success"]})):this._snackBar.open(c.message??"Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]})},error:c=>{this.isLoadingData=!1,navigator.onLine?c.status===401?this._authService.logout():this.setGenericError():this.errorData={imgSrc:"no-signal.png",errorTitleMessage:"Internet connection lost",errorSubTitleMessage:"Please check your connection."},this.isError=!0}}))})}blobImg="empty-profile-picture.png";handleImageError(t){let e=t.target;e.src=this.blobImg,e.alt="Default user profile image",e.loading="lazy",e.decoding="async"}isExportingExcelData=!1;exportExcel(){let t={pageIndex:this.pageNumber,pageSize:this.pageSize,searchString:this.filterForm.value.searchString||""};this.totalRecords>this.schools.length?(this.isExportingExcelData=!0,this._schoolService.apiSchoolGetSchoolsPost(t).subscribe({next:e=>{this.isExportingExcelData=!1,this.formatDownExcelData(e.data??[])},error:e=>{this.isExportingExcelData=!1,this._snackBar.open("Failed to export data. Please try again later.","Close",{duration:3e3,panelClass:["snack-error"]})}})):this.formatDownExcelData(this.schools)}formatDownExcelData(t){let e=[{header:"Name",selector:r=>r.name},{header:"Email",selector:r=>r.emailId},{header:"Phone No",selector:r=>r.phoneNumber},{header:"City",selector:r=>r.cityName}];this._generateExcelService.downloadJsonAsXlsx({rows:t,columns:e,fileName:"Schools_Data",sheetName:"Schools Data"})}static \u0275fac=function(e){return new(e||i)(g(j),g(M),g(A),g(U),g(Z),g(se))};static \u0275cmp=P({type:i,selectors:[["app-list",8,"component"]],attrs:Ee,decls:21,vars:4,consts:[[1,"main-container"],[1,"header"],[1,"header-left"],[1,"page-title"],[1,"breadcrumb"],["routerLink","/admin/dashboard"],[1,"separator"],[1,"header-right",3,"formGroup"],["type","text","placeholder","Search...","formControlName","searchString",1,"search-input"],["routerLink","/admin/schools/add",1,"add-button"],["fxLayoutAlign","center center",1,"loading-page-ui"],[1,"error-page-ui"],[3,"errorData"],[1,"table-wrapper"],[1,"table-ui"],[1,"paginator-wrapper"],[1,"form-actions"],[1,"submit",3,"click","disabled"],[1,"spinner"],["alt","profilePicture",1,"profilePicture",3,"error","src"],[1,"edit-button",3,"click"],[1,"delete-button",3,"click"],[1,"pagination-controls"],[3,"change","value"],[3,"value"],[3,"click","disabled"]],template:function(e,r){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),a(5,"Schools"),n()(),o(6,"div",4)(7,"span")(8,"a",5),a(9,"Home"),n()(),o(10,"span",6),a(11,"/"),n(),o(12,"span"),a(13,"Schools"),n()()(),o(14,"form",7),h(15,"input",8),o(16,"button",9),a(17,"Add"),n()()(),d(18,ve,2,0,"div",10),d(19,xe,2,1,"div",11),d(20,ye,26,4),n()),e&2&&(l(14),u("formGroup",r.filterForm),l(4),s(r.isLoadingData&&!r.isError?18:-1),l(),s(!r.isLoadingData&&r.isError?19:-1),l(),s(!r.isLoadingData&&!r.isError?20:-1))},dependencies:[T,L,N,ae,re,$,G,z,H,k,R,V,q,B],encapsulation:2})};function Fe(i,t){i&1&&(X(0),h(1,"i",50),o(2,"h5"),a(3,"Upload File"),n(),K())}function De(i,t){if(i&1){let e=I();X(0),o(1,"img",51),S("error",function(c){E(e);let f=m();return C(f.handleImageError(c))}),n(),K()}if(i&2){let e=m();l(),u("src",e.croppedBlogImage,D)}}function Pe(i,t){i&1&&(o(0,"span"),a(1,"School name is required"),n())}function Te(i,t){i&1&&(o(0,"span"),a(1,"Aleast 3 characters required"),n())}function Ae(i,t){i&1&&(o(0,"span"),a(1,"Almost 50 characters"),n())}function Ne(i,t){if(i&1&&(o(0,"div",20),d(1,Pe,2,0,"span"),d(2,Te,2,0,"span"),d(3,Ae,2,0,"span"),n()),i&2){let e=m();l(),s(e.addOrEditSchoolForm.controls.name.errors!=null&&e.addOrEditSchoolForm.controls.name.errors.required?1:-1),l(),s(e.addOrEditSchoolForm.controls.name.errors!=null&&e.addOrEditSchoolForm.controls.name.errors.minlength?2:-1),l(),s(e.addOrEditSchoolForm.controls.name.errors!=null&&e.addOrEditSchoolForm.controls.name.errors.maxlength?3:-1)}}function Le(i,t){i&1&&(o(0,"span"),a(1,"Phone number is required"),n())}function Me(i,t){i&1&&(o(0,"span"),a(1,"Please enter valid phone number"),n())}function ke(i,t){if(i&1&&(o(0,"div",20),d(1,Le,2,0,"span"),d(2,Me,2,0,"span"),n()),i&2){let e=m();l(),s(e.addOrEditSchoolForm.controls.phoneNumber.errors!=null&&e.addOrEditSchoolForm.controls.phoneNumber.errors.required?1:-1),l(),s(e.addOrEditSchoolForm.controls.phoneNumber.errors!=null&&e.addOrEditSchoolForm.controls.phoneNumber.errors.pattern?2:-1)}}function Re(i,t){i&1&&(o(0,"span"),a(1,"Email id is required"),n())}function Ve(i,t){i&1&&(o(0,"span"),a(1,"Please enter valid email"),n())}function Ge(i,t){if(i&1&&(o(0,"div",20),d(1,Re,2,0,"span"),d(2,Ve,2,0,"span"),n()),i&2){let e=m();l(),s(e.addOrEditSchoolForm.controls.emailId.errors!=null&&e.addOrEditSchoolForm.controls.emailId.errors.required?1:-1),l(),s(e.addOrEditSchoolForm.controls.emailId.errors!=null&&e.addOrEditSchoolForm.controls.emailId.errors.email?2:-1)}}function qe(i,t){i&1&&(o(0,"span"),a(1,"address is required"),n())}function Be(i,t){i&1&&(o(0,"span"),a(1,"Aleast 3 characters required"),n())}function ze(i,t){i&1&&(o(0,"span"),a(1,"Almost 60 characters"),n())}function He(i,t){if(i&1&&(o(0,"div",20),d(1,qe,2,0,"span"),d(2,Be,2,0,"span"),d(3,ze,2,0,"span"),n()),i&2){let e=m();l(),s(e.addOrEditSchoolForm.controls.street.errors!=null&&e.addOrEditSchoolForm.controls.street.errors.required?1:-1),l(),s(e.addOrEditSchoolForm.controls.street.errors!=null&&e.addOrEditSchoolForm.controls.street.errors.minlength?2:-1),l(),s(e.addOrEditSchoolForm.controls.street.errors!=null&&e.addOrEditSchoolForm.controls.street.errors.maxlength?3:-1)}}function $e(i,t){if(i&1&&(o(0,"option",31),a(1),n()),i&2){let e=t.$implicit;u("value",e.value),l(),v(" ",e.label," ")}}function je(i,t){i&1&&(o(0,"span"),a(1,"Country is required"),n())}function Ue(i,t){if(i&1&&(o(0,"div",20),d(1,je,2,0,"span"),n()),i&2){let e=m();l(),s(e.addOrEditSchoolForm.controls.countryId.errors!=null&&e.addOrEditSchoolForm.controls.countryId.errors.required||e.addOrEditSchoolForm.controls.countryId.errors!=null&&e.addOrEditSchoolForm.controls.countryId.errors.min?1:-1)}}function Ze(i,t){if(i&1&&(o(0,"option",31),a(1),n()),i&2){let e=t.$implicit;u("value",e.value),l(),v(" ",e.label," ")}}function Je(i,t){i&1&&(o(0,"span"),a(1,"State is required"),n())}function We(i,t){if(i&1&&(o(0,"div",20),d(1,Je,2,0,"span"),n()),i&2){let e=m();l(),s(e.addOrEditSchoolForm.controls.stateId.errors!=null&&e.addOrEditSchoolForm.controls.stateId.errors.required||e.addOrEditSchoolForm.controls.stateId.errors!=null&&e.addOrEditSchoolForm.controls.stateId.errors.min?1:-1)}}function Xe(i,t){if(i&1&&(o(0,"option",31),a(1),n()),i&2){let e=t.$implicit;u("value",e.value),l(),v(" ",e.label," ")}}function Ke(i,t){i&1&&(o(0,"span"),a(1,"City is required"),n())}function Qe(i,t){if(i&1&&(o(0,"div",20),d(1,Ke,2,0,"span"),n()),i&2){let e=m();l(),s(e.addOrEditSchoolForm.controls.cityId.errors!=null&&e.addOrEditSchoolForm.controls.cityId.errors.required||e.addOrEditSchoolForm.controls.cityId.errors!=null&&e.addOrEditSchoolForm.controls.cityId.errors.min?1:-1)}}function Ye(i,t){i&1&&(o(0,"span"),a(1,"Pincode is required"),n())}function et(i,t){i&1&&(o(0,"span"),a(1,"Please eneter valid pincode"),n())}function tt(i,t){if(i&1&&(o(0,"div",20),d(1,Ye,2,0,"span"),d(2,et,2,0,"span"),n()),i&2){let e=m();l(),s(e.addOrEditSchoolForm.controls.pincode.errors!=null&&e.addOrEditSchoolForm.controls.pincode.errors.required?1:-1),l(),s(e.addOrEditSchoolForm.controls.pincode.errors!=null&&e.addOrEditSchoolForm.controls.pincode.errors.pattern?2:-1)}}function it(i,t){i&1&&h(0,"i",43)}function ot(i,t){i&1&&h(0,"i",44)}function nt(i,t){i&1&&(o(0,"span"),a(1,"Password is required"),n())}function rt(i,t){i&1&&(o(0,"span"),a(1,"Password must contain at least 8 characters"),n())}function at(i,t){i&1&&(o(0,"span"),a(1,"Password must be less than 15 characters"),n())}function lt(i,t){i&1&&(o(0,"span"),a(1,"Password must contain at least 1 uppercase, 1 lowercase, 1 special character, and 1 number"),n())}function dt(i,t){if(i&1&&(o(0,"div",20),d(1,nt,2,0,"span"),d(2,rt,2,0,"span"),d(3,at,2,0,"span"),d(4,lt,2,0,"span"),n()),i&2){let e=m();l(),s(e.addOrEditSchoolForm.controls.password.errors!=null&&e.addOrEditSchoolForm.controls.password.errors.required?1:-1),l(),s(!(e.addOrEditSchoolForm.controls.password.errors!=null&&e.addOrEditSchoolForm.controls.password.errors.maxlength)&&(e.addOrEditSchoolForm.controls.password.errors!=null&&e.addOrEditSchoolForm.controls.password.errors.pattern)&&!(e.addOrEditSchoolForm.controls.password.errors!=null&&e.addOrEditSchoolForm.controls.password.errors.required)&&(e.addOrEditSchoolForm.controls.password.errors!=null&&e.addOrEditSchoolForm.controls.password.errors.minlength)?2:-1),l(),s(e.addOrEditSchoolForm.controls.password.errors!=null&&e.addOrEditSchoolForm.controls.password.errors.maxlength&&!(e.addOrEditSchoolForm.controls.password.errors!=null&&e.addOrEditSchoolForm.controls.password.errors.required)&&!(e.addOrEditSchoolForm.controls.password.errors!=null&&e.addOrEditSchoolForm.controls.password.errors.minlength)?3:-1),l(),s(e.addOrEditSchoolForm.controls.password.errors!=null&&e.addOrEditSchoolForm.controls.password.errors.pattern&&!(e.addOrEditSchoolForm.controls.password.errors!=null&&e.addOrEditSchoolForm.controls.password.errors.required)&&!(e.addOrEditSchoolForm.controls.password.errors!=null&&e.addOrEditSchoolForm.controls.password.errors.minlength)&&!(e.addOrEditSchoolForm.controls.password.errors!=null&&e.addOrEditSchoolForm.controls.password.errors.maxlength)?4:-1)}}function st(i,t){i&1&&h(0,"i",43)}function ct(i,t){i&1&&h(0,"i",44)}function mt(i,t){i&1&&(o(0,"span"),a(1,"Confirm password is required"),n())}function pt(i,t){i&1&&(o(0,"span"),a(1,"Passwords do not match."),n())}function ut(i,t){if(i&1&&(o(0,"div",20),d(1,mt,2,0,"span"),d(2,pt,2,0,"span"),n()),i&2){let e=m();l(),s(e.addOrEditSchoolForm.controls.confirmPassword.errors!=null&&e.addOrEditSchoolForm.controls.confirmPassword.errors.required?1:-1),l(),s(!(e.addOrEditSchoolForm.controls.confirmPassword.errors!=null&&e.addOrEditSchoolForm.controls.confirmPassword.errors.required)&&(e.addOrEditSchoolForm.errors!=null&&e.addOrEditSchoolForm.errors.passwordMismatch)?2:-1)}}function ht(i,t){i&1&&h(0,"span",49)}var F=class i{constructor(t,e,r,c,f,ce,St){this._schoolService=t;this._route=e;this._dropDownService=r;this._router=c;this._authenticationService=f;this._snackBar=ce;this._dialog=St}addOrEditSchoolForm=new y({name:new _("",[p.required,p.minLength(3),p.maxLength(50)]),emailId:new _("",[p.required,p.email]),phoneNumber:new _("",[p.required,p.pattern("^[6-9]{1}[0-9]{9}$")]),street:new _("",[p.required,p.minLength(3),p.maxLength(60)]),pincode:new _("",[p.required,p.pattern("^[0-9]{6}$")]),countryId:new _(0,[p.required,p.min(1)]),stateId:new _({value:0,disabled:!0},[p.required,p.min(1)]),cityId:new _({value:0,disabled:!0},[p.required,p.min(1)]),profilePicture:new _(""),password:new _("",[p.required,p.pattern("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[^\\da-zA-Z_]).{8,}$"),p.maxLength(15),p.minLength(8)]),confirmPassword:new _("",[p.required])},{validators:this.passwordsMatchValidator});passwordsMatchValidator(t){let e=t,r=e.get("password")?.value,c=e.get("confirmPassword")?.value;return r===c?null:{passwordMismatch:!0}}get form(){return this.addOrEditSchoolForm}countries=[];states=[];cities=[];isLoading=!1;schoolId=null;croppedBlogImage;uploadBlogImage;isLoadingData=!1;isError=!1;errorData;blobImg="empty-profile-picture.png";showPassword=!1;togglePasswordVisibility(){this.showPassword=!this.showPassword}showConfirmPassword=!1;toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}ngOnInit(){this._dropDownService.apiDropDownGetCountryDropDownGet().subscribe({next:t=>{this.countries=t??[]}}),this.schoolId=Number(this._route.snapshot.queryParamMap.get("schoolId")),this.schoolId&&(this.isLoadingData=!0,this._schoolService.apiSchoolGetSchoolGet(this.schoolId).subscribe({next:t=>{this.isLoadingData=!1,t.statusCode===200&&t.data?(this.addOrEditSchoolForm.patchValue(t.data),this.addOrEditSchoolForm.controls.stateId.enable(),this.addOrEditSchoolForm.controls.cityId.enable(),this.addOrEditSchoolForm.get("confirmPassword")?.setValue(t.data.password??""),this.croppedBlogImage=`data:image/png;base64,${t.data.profilePicture??""}`,this.form.get("countryId")?.setValue(t.data.countryId??null),this._dropDownService.apiDropDownGetStateDropDownGet(t.data.countryId).subscribe({next:e=>{this.states=e??[],setTimeout(()=>{this.form.get("stateId")?.setValue(t.data?.stateId??null)}),this._dropDownService.apiDropDownGetCityDropDownGet(t.data?.stateId).subscribe({next:r=>{this.cities=r??[],setTimeout(()=>{this.form.get("cityId")?.setValue(t.data?.cityId??null)})}})}})):this.setErrorState("Something went wrong","Please try after sometime!")},error:t=>{this.isLoadingData=!1,navigator.onLine?t.status===401?this._authenticationService.logout():this.setErrorState("Something went wrong","Please try after sometime!"):this.setErrorState("Internet connection lost","Please check your internet connection!","../../../../../assets/images/icons/no-signal.png")}}))}setErrorState(t,e,r="../../../../../assets/images/icons/error.png"){this.isError=!0,this.errorData={imgSrc:r,errorTitleMessage:t,errorSubTitleMessage:e}}onSubmit(){if(!this.addOrEditSchoolForm.valid){this._snackBar.open("Please enter all required details","Close",{duration:3e3,panelClass:["snack-error"]}),this.addOrEditSchoolForm.markAllAsTouched();return}this.isLoading=!0,this.addOrEditSchoolForm.disable();let t=this.addOrEditSchoolForm.value;if(this.schoolId){let e={id:this.schoolId,name:t.name??"",emailId:t.emailId??"",phoneNumber:t.phoneNumber??"",street:t.street??"",pincode:t.pincode??"",cityId:t.cityId??void 0,stateId:t.stateId??void 0,countryId:t.countryId??void 0,profilePicture:t.profilePicture??"",password:t.password??""};this._schoolService.apiSchoolUpdateStaffPost(e).subscribe({next:r=>{this.handleResponse(r,"School updated successfully")},error:r=>{this.handleError(r)}})}else{let e={name:t.name??"",emailId:t.emailId??"",phoneNumber:t.phoneNumber??"",street:t.street??"",pincode:t.pincode??"",cityId:t.cityId??void 0,stateId:t.stateId??void 0,countryId:t.countryId??void 0,profilePicture:t.profilePicture??"",password:t.password??""};this._schoolService.apiSchoolAddSchoolPost(e).subscribe({next:r=>{this.handleResponse(r,"School added successfully")},error:r=>{this.handleError(r)}})}}handleResponse(t,e){this.isLoading=!1,this.addOrEditSchoolForm.enable(),t.statusCode===200?(this._router.navigateByUrl("/admin/schools/list"),this._snackBar.open(t.message??e,"Close",{duration:3e3,panelClass:["snack-success"]})):this._snackBar.open(t.message??"Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]})}handleError(t){this.isLoading=!1,this.addOrEditSchoolForm.enable(),navigator.onLine?t.status===401?this._authenticationService.logout():this._snackBar.open("Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]}):this._snackBar.open("Internet Connection Lost, Please check your connectivity","Close",{duration:3e3,panelClass:["snack-error"]})}uploadImage(){this._dialog.open(le,{width:"500px",data:1/1}).afterClosed().subscribe(t=>{t&&(this.croppedBlogImage=t?.croppedImage,this.uploadBlogImage=t?.base64String,this.form.get("profilePicture")?.setValue(t?.base64String))})}onCountryChange(t){let e=t.target,r=Number(e.value);r&&(this.addOrEditSchoolForm.value.countryId=r,this.form.get("countryId")?.setValue(r),this.form.get("stateId")?.reset(),this.form.get("stateId")?.enable(),this.form.get("cityId")?.reset(),this.states=[],this.cities=[],this._dropDownService.apiDropDownGetStateDropDownGet(r).subscribe({next:c=>this.states=c??[]}))}onStateChange(t){let e=t.target,r=Number(e.value);r&&(this.addOrEditSchoolForm.value.stateId=r,this.form.get("stateId")?.setValue(r),this.form.get("cityId")?.reset(),this.form.get("cityId")?.enable(),this.cities=[],this._dropDownService.apiDropDownGetCityDropDownGet(r).subscribe({next:c=>this.cities=c??[]}))}handleImageError(t){let e=t.target;e.src=this.blobImg,e.alt="Default user profile image",e.loading="lazy",e.decoding="async"}static \u0275fac=function(e){return new(e||i)(g(j),g(ee),g(ne),g(A),g(M),g(U),g(Z))};static \u0275cmp=P({type:i,selectors:[["app-add-or-edit"]],decls:141,vars:24,consts:[[1,"main-container"],[1,"header"],[1,"header-left"],[1,"page-title"],[1,"breadcrumb"],["routerLink","/admin/dashboard"],[1,"separator"],["routerLink","/admin/schools/list"],[1,"form-container"],[3,"ngSubmit","formGroup"],[1,"form-body"],[1,"profile-container"],[1,"profile-section"],[1,"image-cropper-wrapper",3,"click"],[1,"profile-basic-info"],[1,"form-row"],[1,"form-group"],["for","name"],[1,"text-warn"],["type","text","formControlName","name","id","name","oninput","this.value = this.value.trimStart();","autocomplete","off"],[1,"error"],["for","phoneNumber"],["type","tel","formControlName","phoneNumber","id","phoneNumber","oninput","this.value = this.value.replace(/[^0-9]/g, '');","maxlength","10","minlength","10","autocomplete","off","aria-label","Mobile Number"],["for","emailId"],["type","text","formControlName","emailId","id","emailId","oninput","this.value = this.value.trim();","autocomplete","off","aria-label","Email"],[1,"address-container"],["for","street"],["type","text","formControlName","street","id","street"],["for","countryId"],["formControlName","countryId",3,"change"],["value",""],[3,"value"],["for","stateId"],["formControlName","stateId",3,"change"],["for","cityId"],["formControlName","cityId"],["for","pincode"],["type","tel","formControlName","pincode","id","pincode","oninput","this.value = this.value.replace(/[^0-9]/g, '');","maxlength","6","minlength","6"],[1,"password-container"],["for","password"],[1,"password-wrapper"],["id","password","formControlName","password","placeholder","Enter your password",3,"type"],[1,"toggle-icon",3,"click"],[1,"fa","fa-eye-slash"],[1,"fa","fa-eye"],["for","confirmPassword"],["id","confirmPassword","formControlName","confirmPassword","placeholder","Enter your confirm password",3,"type"],[1,"form-actions"],["type","submit",1,"submit",3,"disabled"],[1,"spinner"],[1,"fa-solid","fa-image"],["alt","Cropped Image",3,"error","src"]],template:function(e,r){e&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),a(5),n()(),o(6,"div",4)(7,"span")(8,"a",5),a(9,"Home"),n()(),o(10,"span",6),a(11,"/"),n(),o(12,"span")(13,"a",7),a(14,"Schools"),n()(),o(15,"span",6),a(16,"/"),n(),o(17,"span"),a(18),n()()()(),o(19,"div",8)(20,"form",9),S("ngSubmit",function(){return r.onSubmit()}),o(21,"div",10)(22,"div",11)(23,"div",12)(24,"label"),a(25,"Image"),n(),o(26,"div",13),S("click",function(){return r.uploadImage()}),d(27,Fe,4,0,"ng-container"),d(28,De,2,1,"ng-container"),n()(),o(29,"div",14)(30,"div")(31,"h3"),a(32,"Basic Info:"),n()(),o(33,"div",15)(34,"div",16)(35,"label",17),a(36,"School Name"),o(37,"span",18),a(38,"*"),n()(),h(39,"input",19),d(40,Ne,4,3,"div",20),n()(),o(41,"div",15)(42,"div",16)(43,"label",21),a(44,"Phone No."),o(45,"span",18),a(46,"*"),n()(),h(47,"input",22),d(48,ke,3,2,"div",20),n(),o(49,"div",16)(50,"label",23),a(51,"Email"),o(52,"span",18),a(53,"*"),n()(),h(54,"input",24),d(55,Ge,3,2,"div",20),n()()()(),o(56,"div",25)(57,"div")(58,"h3"),a(59,"Address"),n()(),o(60,"div",15)(61,"div",16)(62,"label",26),a(63,"Building No. / Area of Locality / Street"),o(64,"span",18),a(65,"*"),n()(),h(66,"input",27),d(67,He,4,3,"div",20),n()(),o(68,"div",15)(69,"div",16)(70,"label",28),a(71,"Country"),o(72,"span",18),a(73,"*"),n()(),o(74,"select",29),S("change",function(f){return r.onCountryChange(f)}),o(75,"option",30),a(76,"Select Country"),n(),w(77,$e,2,2,"option",31,x),n(),d(79,Ue,2,1,"div",20),n(),o(80,"div",16)(81,"label",32),a(82,"State"),o(83,"span",18),a(84,"*"),n()(),o(85,"select",33),S("change",function(f){return r.onStateChange(f)}),o(86,"option",30),a(87,"Select State"),n(),w(88,Ze,2,2,"option",31,x),n(),d(90,We,2,1,"div",20),n()(),o(91,"div",15)(92,"div",16)(93,"label",34),a(94,"City"),o(95,"span",18),a(96,"*"),n()(),o(97,"select",35)(98,"option",30),a(99,"Select City"),n(),w(100,Xe,2,2,"option",31,x),n(),d(102,Qe,2,1,"div",20),n(),o(103,"div",16)(104,"label",36),a(105,"Pincode"),o(106,"span",18),a(107,"*"),n()(),h(108,"input",37),d(109,tt,3,2,"div",20),n()()(),o(110,"div",38)(111,"div")(112,"h3"),a(113,"Password"),n()(),o(114,"div",15)(115,"div",16)(116,"label",39),a(117,"New Password"),o(118,"span",18),a(119,"*"),n()(),o(120,"div",40),h(121,"input",41),o(122,"span",42),S("click",function(){return r.togglePasswordVisibility()}),d(123,it,1,0,"i",43),d(124,ot,1,0,"i",44),n()(),d(125,dt,5,4,"div",20),n(),o(126,"div",16)(127,"label",45),a(128,"Confirm Password"),o(129,"span",18),a(130,"*"),n()(),o(131,"div",40),h(132,"input",46),o(133,"span",42),S("click",function(){return r.toggleConfirmPasswordVisibility()}),d(134,st,1,0,"i",43),d(135,ct,1,0,"i",44),n()(),d(136,ut,3,2,"div",20),n()()()(),o(137,"div",47)(138,"button",48),d(139,ht,1,0,"span",49),a(140),n()()()()()),e&2&&(l(5),v("",r.schoolId?"Edit":"Add"," School"),l(13),v("",r.schoolId?"Edit":"Add"," School"),l(2),u("formGroup",r.addOrEditSchoolForm),l(7),s(r.croppedBlogImage?-1:27),l(),s(r.croppedBlogImage?28:-1),l(12),s(r.addOrEditSchoolForm.controls.name.touched&&r.addOrEditSchoolForm.controls.name.invalid?40:-1),l(8),s(r.addOrEditSchoolForm.controls.phoneNumber.touched&&r.addOrEditSchoolForm.controls.phoneNumber.invalid?48:-1),l(7),s(r.addOrEditSchoolForm.controls.emailId.touched&&r.addOrEditSchoolForm.controls.emailId.invalid?55:-1),l(12),s(r.addOrEditSchoolForm.controls.street.touched&&r.addOrEditSchoolForm.controls.street.invalid?67:-1),l(10),b(r.countries),l(2),s(r.addOrEditSchoolForm.controls.countryId.touched&&r.addOrEditSchoolForm.controls.countryId.invalid?79:-1),l(9),b(r.states),l(2),s(r.addOrEditSchoolForm.controls.stateId.touched&&r.addOrEditSchoolForm.controls.stateId.invalid?90:-1),l(10),b(r.cities),l(2),s(r.addOrEditSchoolForm.controls.cityId.touched&&r.addOrEditSchoolForm.controls.cityId.invalid?102:-1),l(7),s(r.addOrEditSchoolForm.controls.pincode.touched&&r.addOrEditSchoolForm.controls.pincode.invalid?109:-1),l(12),u("type",r.showPassword?"text":"password"),l(2),s(r.showPassword?123:-1),l(),s(r.showPassword?-1:124),l(),s(r.addOrEditSchoolForm.controls.password.touched&&r.addOrEditSchoolForm.controls.password.invalid?125:-1),l(7),u("type",r.showConfirmPassword?"text":"password"),l(2),s(r.showConfirmPassword?134:-1),l(),s(r.showConfirmPassword?-1:135),l(),s(r.addOrEditSchoolForm.controls.confirmPassword.touched?136:-1),l(2),u("disabled",r.isLoading),l(),s(r.isLoading?139:-1),l(),v(" ",r.isLoading?"Submitting...":"Submit"," "))},dependencies:[$,G,z,H,k,te,R,V,ie,oe,q,B,T,L,N],encapsulation:2})};var kt=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:J},{path:"add",component:F},{path:"edit",component:F}];export{kt as schoolsRoutes};
