import{a as ze}from"./chunk-J35TZ3AM.js";import{a as Se}from"./chunk-ABOBCSHE.js";import{A as W,b as k,d as F,e as A,f as L,g as O,h as b,i as R,j as ke,k as B,n as V,o as Z,p as G,q as z,r as Ae,s as Le,t as Re,u as Be,v as q}from"./chunk-L7HYSWOG.js";import{c as ge,g as $,i as Q,j as ee}from"./chunk-DZGCCUOH.js";import{a as Ve,b as Ge,c as te,g as qe}from"./chunk-FDP5VDWE.js";import"./chunk-LCCYGYQT.js";import{Aa as c,Ab as ue,Ba as p,Bb as w,Ca as N,Da as I,Ea as D,Fa as f,Ga as n,Ha as i,Ia as C,Ja as s,Ka as m,La as ie,Ma as ne,Na as oe,Nb as X,O as x,Oa as P,P as v,Pb as T,Qa as _,Qb as H,Ra as De,Sa as u,Tb as U,Ub as Y,a as le,ab as t,b as se,bb as S,cb as E,db as y,ea as me,eb as J,fa as Oe,gb as K,ha as r,hb as ce,jb as pe,la as h,oa as M,ta as Ie,u as j,xb as Te}from"./chunk-M53X7M2I.js";var je=["class","component"],He=()=>[10,20,30,50];function Ue(a,o){if(a&1&&(n(0,"option",9),t(1),i()),a&2){let e=o.$implicit;f("ngValue",e.value),r(),E(" ",e.label," ")}}function Ye(a,o){if(a&1&&(n(0,"option",11),t(1),i()),a&2){let e=o.$implicit;f("value",e),r(),y("",e,"-",e+1)}}function We(a,o){a&1&&(n(0,"div",14),C(1,"app-loading-page"),i())}function Je(a,o){if(a&1&&(n(0,"div",15),C(1,"app-error-page",16),i()),a&2){let e=u();r(),f("errorData",e.errorData)}}function Ke(a,o){if(a&1){let e=P();n(0,"tr")(1,"td"),t(2),i(),n(3,"td")(4,"img",23),_("error",function(l){x(e);let g=u(2);return v(g.handleImageError(l))}),i()(),n(5,"td"),t(6),i(),n(7,"td"),t(8),i(),n(9,"td"),t(10),i(),n(11,"td"),t(12),i(),n(13,"td"),t(14),i(),n(15,"td"),t(16),i(),n(17,"td"),t(18),i(),n(19,"td"),t(20),i(),n(21,"td"),t(22),i(),n(23,"td"),t(24),i(),n(25,"td"),t(26),i(),n(27,"td"),t(28),i(),n(29,"td"),t(30),i(),n(31,"td"),t(32),i(),n(33,"td"),t(34),i(),n(35,"td")(36,"button",24),_("click",function(){let l=x(e).$implicit,g=u(2);return v(g.getStudentFeesDetails(l.id))}),t(37," View / Collect Fee "),i(),n(38,"button",25),_("click",function(){let l=x(e).$implicit,g=u(2);return v(g.editDetails(l.id))}),t(39," Edit "),i(),n(40,"button",26),_("click",function(){let l=x(e).$implicit,g=u(2);return v(g.delete(l))}),t(41,"Delete"),i()()()}if(a&2){let e=o.$implicit,d=o.$index;r(2),S(d+1),r(2),f("src",`data:image/png;base64,${e.studentImg}`,me),r(2),S(e.affiliation),r(2),S(e.admissionNo),r(2),S(e.fName),r(2),S(e.class),r(2),S(e.section),r(2),S(e.fatherName),r(2),S(e.phone),r(2),S(e.address),r(2),S(e.year),r(2),S(e.boardingPoint),r(2),S(e.busNo),r(2),S(e.routeCost),r(2),S(e.totalPaid),r(2),S(((e==null?null:e.routeCost)||0)-((e==null?null:e.totalPaid)||0)),r(2),S(e.remark)}}function Xe(a,o){if(a&1&&(n(0,"option",11),t(1),i()),a&2){let e=o.$implicit;f("value",e),r(),E(" ",e," ")}}function Ze(a,o){if(a&1){let e=P();n(0,"div",19)(1,"div",27)(2,"label"),t(3,"Items per page:"),i(),n(4,"select",28),_("change",function(l){x(e);let g=u(2);return v(g.onPageSizeChange(l))}),I(5,Xe,2,2,"option",11,N),i(),n(7,"span"),t(8),i(),n(9,"button",29),_("click",function(){x(e);let l=u(2);return v(l.goToFirstPage())}),t(10," \xAB "),i(),n(11,"button",29),_("click",function(){x(e);let l=u(2);return v(l.goToPreviousPage())}),t(12," \u2039 "),i(),n(13,"button",29),_("click",function(){x(e);let l=u(2);return v(l.goToNextPage())}),t(14," \u203A "),i(),n(15,"button",29),_("click",function(){x(e);let l=u(2);return v(l.goToLastPage())}),t(16," \xBB "),i()()()}if(a&2){let e=u(2);r(4),f("value",e.pageSize),r(),D(K(8,He)),r(3),J("",e.pageNumber*e.pageSize+1," - ",e.getEndItemIndex()," of ",e.totalRecords),r(),f("disabled",e.pageNumber===0),r(2),f("disabled",e.pageNumber===0),r(2),f("disabled",e.pageNumber+1>=e.totalPages),r(2),f("disabled",e.pageNumber+1>=e.totalPages)}}function Qe(a,o){a&1&&C(0,"span",22)}function et(a,o){if(a&1){let e=P();n(0,"div",17)(1,"table",18)(2,"thead")(3,"tr")(4,"th"),t(5,"Sl.No"),i(),n(6,"th"),t(7,"Profile Image"),i(),n(8,"th"),t(9,"Affiliation"),i(),n(10,"th"),t(11,"Admission No"),i(),n(12,"th"),t(13,"Name"),i(),n(14,"th"),t(15,"Class"),i(),n(16,"th"),t(17,"Section"),i(),n(18,"th"),t(19,"Father Name"),i(),n(20,"th"),t(21,"Phone"),i(),n(22,"th"),t(23,"Address"),i(),n(24,"th"),t(25,"Year"),i(),n(26,"th"),t(27,"Route"),i(),n(28,"th"),t(29,"Bus No"),i(),n(30,"th"),t(31,"Amount"),i(),n(32,"th"),t(33,"Total Paid"),i(),n(34,"th"),t(35,"Due"),i(),n(36,"th"),t(37,"Remark"),i(),n(38,"th"),t(39,"Action"),i()()(),n(40,"tbody"),I(41,Ke,42,17,"tr",null,N),i()()(),c(43,Ze,17,9,"div",19),n(44,"div",20)(45,"button",21),_("click",function(){x(e);let l=u();return v(l.exportExcel())}),c(46,Qe,1,0,"span",22),t(47),i()()}if(a&2){let e=u();r(41),D(e.students),r(2),p(e.totalRecords>e.pageSize?43:-1),r(2),f("disabled",e.isExportingExcelData),r(),p(e.isExportingExcelData?46:-1),r(),E(" ",e.isExportingExcelData?"Exporting...":"Export Excel"," ")}}var fe=class a{constructor(o,e,d,l,g,Fe,Ne,we){this._studentService=o;this._authService=e;this._dropDownService=d;this._route=l;this._router=g;this._snackBar=Fe;this._dialog=Ne;this._generateExcelService=we;this.populateYears()}paginatorForm=new O({pageNumber:new b(0),pageSize:new b(10)});filterForm=new O({searchString:new b(null),session:new b(null),schoolId:new b(null)});schools=[];isLoading=!1;isLoadingData=!0;isError=!1;errorData;totalRecords=0;isExportingExcelData=!1;students=[];studentsFees=[];years=[];ngOnInit(){this._dropDownService.apiDropDownGetSchoolDropDownGet().subscribe({next:o=>{this.schools=o||[]}}),this._route.queryParams.subscribe(o=>{let e=o.session;e&&this.filterForm.patchValue({session:e}),this.getStudentsData()}),this.getStudentsData(),this.paginatorForm.valueChanges.pipe(j(500)).subscribe(o=>{this.isLoadingData=!0,this.getStudentsData()}),this.filterForm.valueChanges.pipe(j(500)).subscribe(o=>{this.isLoadingData=!0,this.getStudentsData()})}get pageNumber(){return this.paginatorForm.get("pageNumber")?.value??0}get pageSize(){return this.paginatorForm.get("pageSize")?.value??10}get totalPages(){return Math.ceil(this.totalRecords/this.pageSize)}getEndItemIndex(){let o=(this.pageNumber+1)*this.pageSize;return o>this.totalRecords?this.totalRecords:o}goToFirstPage(){this.paginatorForm.patchValue({pageNumber:0})}goToPreviousPage(){this.pageNumber>0&&this.paginatorForm.patchValue({pageNumber:this.pageNumber-1})}goToNextPage(){this.pageNumber+1<this.totalPages&&this.paginatorForm.patchValue({pageNumber:this.pageNumber+1})}goToLastPage(){this.paginatorForm.patchValue({pageNumber:this.totalPages-1})}onPageSizeChange(o){let e=parseInt(o.target.value,10);this.paginatorForm.patchValue({pageSize:e,pageNumber:0})}getStudentsData(){let o={pageIndex:this.pageNumber,pageSize:this.pageSize,searchString:this.filterForm.value.searchString||"",session:this.filterForm.value.session||null,schoolId:this.filterForm.value.schoolId||null};this.isError=!1,this.errorData=null,this.isLoadingData=!0,this._studentService.apiStudentGetStudentsPost(o).subscribe({next:e=>{this.isLoadingData=!1,e.statusCode===200&&e.data&&Array.isArray(e.data)?(this.isError=!1,this.students=e.data,console.log("students",{data:e.data?.map(d=>({admissionNo:d.admissionNo,fName:d.fName,className:d.class,sectionName:d.section,fatherName:d.fatherName,phoneNo:d.phone,address:d.address,session:o?.session??null,boardingPoint:d.boardingPoint??"N/A",busNo:d.busNo??"N/A",routeCost:d.routeCost??0,totalPaid:d.totalPaid??0,duePayment:(d.routeCost??0)-(d.totalPaid??0)})),fileName:`Students_Data_${o?.session??null}`,sheetName:"Students Fee History",customHeaders:["Admission No","Student Name","Class","Section","Father Name","Phone No","Address","Year","Boarding Point","Bus No","Route Cost","Total Paid","Due Payment"]}),this.totalRecords=e.totalRecords??0):(this.isError=!0,this.errorData={imgSrc:"empty-box.png",errorTitleMessage:"No Data available",errorSubTitleMessage:"Please try to add Students!"})},error:e=>{this.isLoadingData=!1,this.students=[],navigator.onLine?e.status===401?this._authService.logout():this.setGenericError():this.errorData={imgSrc:"no-signal.png",errorTitleMessage:"Internet connection lost",errorSubTitleMessage:"Please check your connection."},this.isError=!0}})}setGenericError(){this.errorData={imgSrc:"error.png",errorTitleMessage:"Something went wrong",errorSubTitleMessage:"Please try again later"}}resetToSearch(){this.filterForm.controls.searchString.reset()}editDetails(o){this._router.navigate(["/admin/students/edit"],{queryParams:{studentId:o}})}delete(o){this._dialog.open(qe,{width:"400px",data:{title:"Confirm",content:`Are you sure, Do you want to delete - ${o?.fName} ${o?.lName}?`}}).afterClosed().subscribe(d=>{d==!0&&(this.isLoadingData=!0,this._studentService.apiStudentDeleteStudentDelete(o?.id).subscribe({next:l=>{this.isLoadingData=!1,l.statusCode===200?(this._snackBar.open("Student deleted successfully","Close",{duration:3e3,panelClass:["snack-error"]}),this.getStudentsData()):this._snackBar.open(l.message??"Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]})}}))})}getStudentFeesDetails(o){this._router.navigate(["/admin/students/fee-list"],{queryParams:{studentId:o}})}populateYears(){let o=new Date().getFullYear();this.years=[];for(let e=o;e>=2020;e--)this.years.push(e)}blobImg="empty-profile-picture.png";handleImageError(o){let e=o.target;e.src=this.blobImg,e.alt="Default user profile image",e.loading="lazy",e.decoding="async"}exportExcel(){let o={pageIndex:0,pageSize:this.totalRecords,searchString:this.filterForm.value.searchString||"",session:this.filterForm.value.session||null,schoolId:this.filterForm.value.schoolId||null};this.totalRecords>this.students.length?(this.isExportingExcelData=!0,this._studentService.apiStudentGetStudentsPost(o).subscribe({next:e=>{this.isExportingExcelData=!1,this.formatDownExcelData(e.data??[])},error:()=>{this.isExportingExcelData=!1,this._snackBar.open("Failed to export data. Please try again later.","Close",{duration:3e3,panelClass:["snack-error"]})}})):this.formatDownExcelData(this.students)}formatDownExcelData(o){let e=(o??[]).map(l=>se(le({},l),{routeCost:l.routeCost??0,totalPaid:l.totalPaid??0,duePayment:(l.routeCost??0)-(l.totalPaid??0)})),d=[{header:"Admission No",selector:l=>l.admissionNo},{header:"Student Name",selector:l=>l.fName},{header:"Class",selector:l=>l.class},{header:"Section",selector:l=>l.section??""},{header:"Father Name",selector:l=>l.fatherName??""},{header:"Phone No",selector:l=>l.phone??""},{header:"Address",selector:l=>l.address??""},{header:"Year",selector:l=>l.year??""},{header:"Boarding Point",selector:l=>l.boardingPoint??""},{header:"Bus No",selector:l=>l.busNo??""},{header:"Route Cost",selector:l=>l.routeCost??""},{header:"Total Paid",selector:l=>l.totalPaid??""},{header:"Due Payment",selector:l=>l.duePayment??""}];this._generateExcelService.downloadJsonAsXlsx({rows:e,columns:d,fileName:"Students_Data",sheetName:"Students Data"})}static \u0275fac=function(e){return new(e||a)(h($),h(Y),h(ge),h(X),h(T),h(W),h(te),h(Se))};static \u0275cmp=M({type:a,selectors:[["app-list",8,"component"]],attrs:je,decls:31,vars:6,consts:[[1,"main-container"],[1,"header"],[1,"header-left"],[1,"page-title"],[1,"breadcrumb"],["routerLink","/admin/dashboard"],[1,"separator"],[1,"header-right",3,"formGroup"],["formControlName","schoolId",1,"search-input"],[3,"ngValue"],["formControlName","session",1,"search-input"],[3,"value"],["type","text","placeholder","Search...","formControlName","searchString",1,"search-input"],["routerLink","/admin/students/add",1,"add-button"],["fxLayoutAlign","center center",1,"loading-page-ui"],[1,"error-page-ui"],[3,"errorData"],[1,"table-wrapper"],[1,"table-ui"],[1,"paginator-wrapper"],[1,"form-actions"],[1,"submit",3,"click","disabled"],[1,"spinner"],["alt","profilePicture",1,"profilePicture",3,"error","src"],[1,"fees-button",3,"click"],[1,"edit-button",3,"click"],[1,"delete-button",3,"click"],[1,"pagination-controls"],[3,"change","value"],[3,"click","disabled"]],template:function(e,d){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),t(5,"Students"),i()(),n(6,"div",4)(7,"span")(8,"a",5),t(9,"Home"),i()(),n(10,"span",6),t(11,"/"),i(),n(12,"span"),t(13,"Students"),i()()(),n(14,"form",7)(15,"select",8)(16,"option",9),t(17,"All Schools"),i(),I(18,Ue,2,2,"option",9,N),i(),n(20,"select",10)(21,"option",9),t(22,"All Academic Years"),i(),I(23,Ye,2,3,"option",11,N),i(),C(25,"input",12),n(26,"button",13),t(27,"Add"),i()()(),c(28,We,2,0,"div",14),c(29,Je,2,1,"div",15),c(30,et,48,4),i()),e&2&&(r(14),f("formGroup",d.filterForm),r(2),f("ngValue",null),r(2),D(d.schools),r(3),f("ngValue",null),r(2),D(d.years),r(5),p(d.isLoadingData&&!d.isError?28:-1),r(),p(!d.isLoadingData&&d.isError?29:-1),r(),p(!d.isLoadingData&&!d.isError?30:-1))},dependencies:[w,U,H,ee,Q,q,R,G,z,k,Z,A,L,B,V],encapsulation:2})};function tt(a,o){a&1&&(ne(0),C(1,"i",51),n(2,"h5"),t(3,"Upload File"),i(),oe())}function it(a,o){if(a&1){let e=P();ne(0),n(1,"img",52),_("error",function(l){x(e);let g=u();return v(g.handleImageError(l))}),i(),oe()}if(a&2){let e=u();r(),f("src",e.croppedBlogImage,me)}}function nt(a,o){a&1&&(n(0,"span"),t(1,"Student name is required"),i())}function ot(a,o){a&1&&(n(0,"span"),t(1,"Aleast 3 characters required"),i())}function at(a,o){a&1&&(n(0,"span"),t(1,"Almost 50 characters"),i())}function rt(a,o){if(a&1&&(n(0,"div",20),c(1,nt,2,0,"span"),c(2,ot,2,0,"span"),c(3,at,2,0,"span"),i()),a&2){let e=u();r(),p(e.addOrEditStudentForm.controls.fName.errors!=null&&e.addOrEditStudentForm.controls.fName.errors.required?1:-1),r(),p(e.addOrEditStudentForm.controls.fName.errors!=null&&e.addOrEditStudentForm.controls.fName.errors.minlength?2:-1),r(),p(e.addOrEditStudentForm.controls.fName.errors!=null&&e.addOrEditStudentForm.controls.fName.errors.maxlength?3:-1)}}function dt(a,o){a&1&&(n(0,"span"),t(1,"Father name is required"),i())}function lt(a,o){a&1&&(n(0,"span"),t(1,"Aleast 3 characters required"),i())}function st(a,o){a&1&&(n(0,"span"),t(1,"Almost 50 characters"),i())}function mt(a,o){if(a&1&&(n(0,"div",20),c(1,dt,2,0,"span"),c(2,lt,2,0,"span"),c(3,st,2,0,"span"),i()),a&2){let e=u();r(),p(e.addOrEditStudentForm.controls.fatherName.errors!=null&&e.addOrEditStudentForm.controls.fatherName.errors.required?1:-1),r(),p(e.addOrEditStudentForm.controls.fatherName.errors!=null&&e.addOrEditStudentForm.controls.fatherName.errors.minlength?2:-1),r(),p(e.addOrEditStudentForm.controls.fatherName.errors!=null&&e.addOrEditStudentForm.controls.fatherName.errors.maxlength?3:-1)}}function ct(a,o){a&1&&(n(0,"span"),t(1,"Phone number is required"),i())}function pt(a,o){a&1&&(n(0,"span"),t(1,"Please enter valid phone number"),i())}function ut(a,o){if(a&1&&(n(0,"div",20),c(1,ct,2,0,"span"),c(2,pt,2,0,"span"),i()),a&2){let e=u();r(),p(e.addOrEditStudentForm.controls.phone.errors!=null&&e.addOrEditStudentForm.controls.phone.errors.required?1:-1),r(),p(e.addOrEditStudentForm.controls.phone.errors!=null&&e.addOrEditStudentForm.controls.phone.errors.pattern?2:-1)}}function gt(a,o){a&1&&(n(0,"span"),t(1,"Admission number is required"),i())}function St(a,o){if(a&1&&(n(0,"div",20),c(1,gt,2,0,"span"),i()),a&2){let e=u();r(),p(e.addOrEditStudentForm.controls.admissionNo.errors!=null&&e.addOrEditStudentForm.controls.admissionNo.errors.required?1:-1)}}function ft(a,o){if(a&1&&(n(0,"option",30),t(1),i()),a&2){let e=o.$implicit;f("value",e),r(),S(e)}}function ht(a,o){a&1&&(n(0,"span"),t(1,"Class is required"),i())}function _t(a,o){if(a&1&&(n(0,"div",20),c(1,ht,2,0,"span"),i()),a&2){let e=u();r(),p(e.addOrEditStudentForm.controls.class.errors!=null&&e.addOrEditStudentForm.controls.class.errors.required?1:-1)}}function Et(a,o){if(a&1&&(n(0,"option",30),t(1),i()),a&2){let e=o.$implicit;f("value",e),r(),S(e)}}function xt(a,o){a&1&&(n(0,"span"),t(1,"Section is required"),i())}function vt(a,o){if(a&1&&(n(0,"div",20),c(1,xt,2,0,"span"),i()),a&2){let e=u();r(),p(e.addOrEditStudentForm.controls.section.errors!=null&&e.addOrEditStudentForm.controls.section.errors.required?1:-1)}}function Ct(a,o){a&1&&(n(0,"span"),t(1,"address is required"),i())}function bt(a,o){a&1&&(n(0,"span"),t(1,"Aleast 3 characters required"),i())}function Ft(a,o){a&1&&(n(0,"span"),t(1,"Almost 60 characters"),i())}function Nt(a,o){if(a&1&&(n(0,"div",20),c(1,Ct,2,0,"span"),c(2,bt,2,0,"span"),c(3,Ft,2,0,"span"),i()),a&2){let e=u();r(),p(e.addOrEditStudentForm.controls.address.errors!=null&&e.addOrEditStudentForm.controls.address.errors.required?1:-1),r(),p(e.addOrEditStudentForm.controls.address.errors!=null&&e.addOrEditStudentForm.controls.address.errors.minlength?2:-1),r(),p(e.addOrEditStudentForm.controls.address.errors!=null&&e.addOrEditStudentForm.controls.address.errors.maxlength?3:-1)}}function It(a,o){a&1&&(n(0,"span"),t(1,"Affiliation is required"),i())}function Dt(a,o){if(a&1&&(n(0,"div",20),c(1,It,2,0,"span"),i()),a&2){let e=u();r(),p(e.addOrEditStudentForm.controls.affiliation.errors!=null&&e.addOrEditStudentForm.controls.affiliation.errors.required?1:-1)}}function Pt(a,o){a&1&&(n(0,"span"),t(1,"Year is required"),i())}function yt(a,o){a&1&&(n(0,"span"),t(1,"Enter valid year"),i())}function Mt(a,o){if(a&1&&(n(0,"div",20),c(1,Pt,2,0,"span"),c(2,yt,2,0,"span"),i()),a&2){let e=u();r(),p(e.addOrEditStudentForm.controls.year.errors!=null&&e.addOrEditStudentForm.controls.year.errors.required?1:-1),r(),p(e.addOrEditStudentForm.controls.year.errors!=null&&e.addOrEditStudentForm.controls.year.errors.min||e.addOrEditStudentForm.controls.year.errors!=null&&e.addOrEditStudentForm.controls.year.errors.max?2:-1)}}function wt(a,o){a&1&&(n(0,"span"),t(1,"Amount is required"),i())}function Ot(a,o){if(a&1&&(n(0,"div",20),c(1,wt,2,0,"span"),i()),a&2){let e=u();r(),p(e.addOrEditStudentForm.controls.amount.errors!=null&&e.addOrEditStudentForm.controls.amount.errors.required||e.addOrEditStudentForm.controls.amount.errors!=null&&e.addOrEditStudentForm.controls.amount.errors.min?1:-1)}}function Tt(a,o){if(a&1&&(n(0,"option",30),t(1),i()),a&2){let e=o.$implicit;f("value",e.id),r(),y(" ",e.boardingPoint," | Bus No: ",e.busNo," ")}}function kt(a,o){a&1&&(n(0,"span"),t(1,"Route is required"),i())}function At(a,o){if(a&1&&(n(0,"div",20),c(1,kt,2,0,"span"),i()),a&2){let e=u();r(),p(e.addOrEditStudentForm.controls.routeId.errors!=null&&e.addOrEditStudentForm.controls.routeId.errors.required||e.addOrEditStudentForm.controls.routeId.errors!=null&&e.addOrEditStudentForm.controls.routeId.errors.min?1:-1)}}function Lt(a,o){a&1&&C(0,"span",50)}var de=class a{constructor(o,e,d,l,g,Fe,Ne){this._studentService=o;this._dropDownService=e;this._route=d;this._router=l;this._authenticationService=g;this._snackBar=Fe;this._dialog=Ne}addOrEditStudentForm=new O({affiliation:new b("",F.required),admissionNo:new b("",F.required),class:new b("",F.required),section:new b("",F.required),fName:new b("",[F.required,F.minLength(3),F.maxLength(50)]),fatherName:new b("",[F.required,F.minLength(3),F.maxLength(50)]),phone:new b("",[F.required,F.pattern("^[6-9]{1}[0-9]{9}$")]),address:new b("",F.required),routeId:new b(0,[F.required,F.min(1)]),studentImg:new b(""),year:new b(0,[F.required,F.min(2020),F.max(new Date().getFullYear())]),remark:new b(""),amount:new b(0,F.required)});routes=[];get form(){return this.addOrEditStudentForm}classes=["Nursery","LKG","UKG","Class 1","Class 2","Class 3","Class 4","Class 5","Class 6","Class 7","Class 8","Class 9","Class 10"];sections=["A","B","C","D","E","F","G","H","I","J"];isLoading=!1;studentId=null;croppedBlogImage;uploadBlogImage;isLoadingData=!1;isError=!1;errorData;blobImg="empty-profile-picture.png";ngOnInit(){this.isLoadingData=!0,this._dropDownService.apiDropDownGetRouteDropDownGet().subscribe({next:o=>{this.isLoadingData=!1,this.routes=o}}),this.studentId=Number(this._route.snapshot.queryParamMap.get("studentId")),this.studentId&&(this.isLoadingData=!0,this._studentService.apiStudentGetStudentGet(this.studentId).subscribe({next:o=>{this.isLoadingData=!1,o.statusCode===200&&o.data?(this.addOrEditStudentForm.patchValue(o.data),this.croppedBlogImage=`data:image/png;base64,${o.data.studentImg??""}`,this.addOrEditStudentForm.get("amount")?.setValue(o.data.totalPaid??0)):this.setErrorState("Something went wrong","Please try after sometime!")},error:o=>{this.isLoadingData=!1,navigator.onLine?o.status===401?this._authenticationService.logout():this.setErrorState("Something went wrong","Please try after sometime!"):this.setErrorState("Internet connection lost","Please check your internet connection!","../../../../../assets/images/icons/no-signal.png")}}))}setErrorState(o,e,d="../../../../../assets/images/icons/error.png"){this.isError=!0,this.errorData={imgSrc:d,errorTitleMessage:o,errorSubTitleMessage:e}}onSubmit(){let o=this.addOrEditStudentForm.value;if(this.studentId)if(this.addOrEditStudentForm.valid){let e={affiliation:o.affiliation??"",admissionNo:o.admissionNo??"",class:o.class??"",section:o.section??"",fName:o.fName??"",fatherName:o.fatherName??"",phone:o.phone??"",address:o.address??"",routeId:o.routeId??0,studentImg:o.studentImg??"",year:o.year??0,remark:o.remark??"",id:this.studentId};this.isLoading=!0,this.addOrEditStudentForm.disable(),this._studentService.apiStudentUpdateStudentPost(e).subscribe({next:d=>{this.isLoading=!1,this.addOrEditStudentForm.enable(),d.statusCode===200?(this._router.navigateByUrl("/admin/students/list"),this._snackBar.open(d.message??"Student updated successfully","Close",{duration:3e3,panelClass:["snack-success"]})):this._snackBar.open(d.message??"Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]})},error:d=>{this.isLoading=!1,this.addOrEditStudentForm.enable(),navigator.onLine?this._snackBar.open("Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]}):d.status==401?this._authenticationService.logout():this._snackBar.open("Internet Connection Lost, Please check your connectivity","Close",{duration:3e3,panelClass:["snack-error"]})}})}else{this._snackBar.open("Please enter student details","Close",{duration:3e3,panelClass:["snack-error"]}),this.addOrEditStudentForm.markAllAsTouched();return}else if(this.addOrEditStudentForm.valid){let e={affiliation:o.affiliation??"",admissionNo:o.admissionNo??"",class:o.class??"",section:o.section??"",fName:o.fName??"",fatherName:o.fatherName??"",phone:o.phone??"",address:o.address??"",routeId:o.routeId??0,studentImg:o.studentImg??"",year:o.year??0,remark:o.remark??""};this.isLoading=!0,this.addOrEditStudentForm.disable(),this._studentService.apiStudentAddStudentPost(e).subscribe({next:d=>{if(this.isLoading=!1,this.addOrEditStudentForm.enable(),d.statusCode===200)if(o.amount&&o.amount>0){let l={paidMode:"cash",studentId:d.data,amount:o.amount??0,paidDate:new Date().toISOString(),comment:""};this.isLoading=!0,this.addOrEditStudentForm.disable(),this._studentService.apiStudentAddStudentFeePost(l).subscribe({next:g=>{this.isLoading=!1,this.addOrEditStudentForm.enable(),g.statusCode===200?(this._router.navigateByUrl("/admin/students/list"),this._snackBar.open(g.message??"student created successfully with first payment","Close",{duration:3e3,panelClass:["snack-success"]})):this._snackBar.open(g.message??"Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]})},error:g=>{this.isLoading=!1,this.addOrEditStudentForm.enable(),navigator.onLine?this._snackBar.open("Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]}):g.status==401?this._authenticationService.logout():this._snackBar.open("Internet Connection Lost, Please check your connectivity","Close",{duration:3e3,panelClass:["snack-error"]})}})}else this._router.navigateByUrl("/admin/students/list"),this._snackBar.open(d.message??"Student created successfully","Close",{duration:3e3,panelClass:["snack-success"]});else this._snackBar.open(d.message??"Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]})},error:d=>{this.isLoading=!1,this.addOrEditStudentForm.enable(),navigator.onLine?this._snackBar.open("Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]}):d.status==401?this._authenticationService.logout():this._snackBar.open("Internet Connection Lost, Please check your connectivity","Close",{duration:3e3,panelClass:["snack-error"]})}})}else{this._snackBar.open("Please enter student details","Close",{duration:3e3,panelClass:["snack-error"]}),this.addOrEditStudentForm.markAllAsTouched();return}}uploadImage(){this._dialog.open(ze,{width:"500px",data:1/1}).afterClosed().subscribe(o=>{o&&(this.croppedBlogImage=o?.croppedImage,this.uploadBlogImage=o?.base64String,this.form.get("studentImg")?.setValue(o?.base64String))})}handleImageError(o){let e=o.target;e.src=this.blobImg,e.alt="Default user profile image",e.loading="lazy",e.decoding="async"}static \u0275fac=function(e){return new(e||a)(h($),h(ge),h(X),h(T),h(Y),h(W),h(te))};static \u0275cmp=M({type:a,selectors:[["app-add-or-edit"]],decls:141,vars:19,consts:[[1,"main-container"],[1,"header"],[1,"header-left"],[1,"page-title"],[1,"breadcrumb"],["routerLink","/admin/dashboard"],[1,"separator"],["routerLink","/admin/students/list"],[1,"form-container"],[3,"ngSubmit","formGroup"],[1,"form-body"],[1,"profile-container"],[1,"profile-section"],[1,"image-cropper-wrapper",3,"click"],[1,"profile-basic-info"],[1,"form-row"],[1,"form-group"],["for","fName"],[1,"text-warn"],["type","text","formControlName","fName","id","fName","oninput","this.value = this.value.trimStart();","autocomplete","off"],[1,"error"],["for","fatherName"],["type","text","formControlName","fatherName","id","fatherName","oninput","this.value = this.value.trimStart();","autocomplete","off"],["for","phone"],["type","tel","formControlName","phone","id","phone","oninput","this.value = this.value.replace(/[^0-9]/g, '');","maxlength","10","minlength","10","autocomplete","off","aria-label","Mobile Number"],["for","admissionNo"],["formControlName","admissionNo","id","admissionNo"],["for","class"],["formControlName","class","id","class"],["value","","disabled",""],[3,"value"],["for","section"],["formControlName","section","id","section"],[1,"basic-container"],["for","address"],["type","text","formControlName","address","id","address"],["for","affiliation"],["formControlName","affiliation","id","affiliation"],["value","ICSE"],["value","CBSE"],["for","year"],["formControlName","year","id","year","oninput","this.value = this.value.replace(/[^0-9]/g, '');","maxlength","4","minlength","4","autocomplete","off"],["for","amount"],["formControlName","amount","id","amount","oninput","this.value = this.value.replace(/[^0-9]/g, '');",1,"form-control"],["for","routeId"],["formControlName","routeId","id","routeId",1,"form-control"],["for","remark"],["formControlName","remark","id","remark"],[1,"form-actions"],["type","submit",1,"submit",3,"disabled"],[1,"spinner"],[1,"fa-solid","fa-image"],["alt","Cropped Image",3,"error","src"]],template:function(e,d){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),t(5),i()(),n(6,"div",4)(7,"span")(8,"a",5),t(9,"Home"),i()(),n(10,"span",6),t(11,"/"),i(),n(12,"span")(13,"a",7),t(14,"Students"),i()(),n(15,"span",6),t(16,"/"),i(),n(17,"span"),t(18),i()()()(),n(19,"div",8)(20,"form",9),_("ngSubmit",function(){return d.onSubmit()}),n(21,"div",10)(22,"div",11)(23,"div",12)(24,"label"),t(25,"Image"),i(),n(26,"div",13),_("click",function(){return d.uploadImage()}),c(27,tt,4,0,"ng-container"),c(28,it,2,1,"ng-container"),i()(),n(29,"div",14)(30,"div",15)(31,"div",16)(32,"label",17),t(33,"Student Name"),n(34,"span",18),t(35,"*"),i()(),C(36,"input",19),c(37,rt,4,3,"div",20),i(),n(38,"div",16)(39,"label",21),t(40,"Father Name"),n(41,"span",18),t(42,"*"),i()(),C(43,"input",22),c(44,mt,4,3,"div",20),i()(),n(45,"div",15)(46,"div",16)(47,"label",23),t(48,"Phone No."),n(49,"span",18),t(50,"*"),i()(),C(51,"input",24),c(52,ut,3,2,"div",20),i(),n(53,"div",16)(54,"label",25),t(55,"Admission No "),n(56,"span",18),t(57,"*"),i()(),C(58,"input",26),c(59,St,2,1,"div",20),i()(),n(60,"div",15)(61,"div",16)(62,"label",27),t(63,"Class "),n(64,"span",18),t(65,"*"),i()(),n(66,"select",28)(67,"option",29),t(68,"Select Class"),i(),I(69,ft,2,2,"option",30,N),i(),c(71,_t,2,1,"div",20),i(),n(72,"div",16)(73,"label",31),t(74,"Section "),n(75,"span",18),t(76,"*"),i()(),n(77,"select",32)(78,"option",29),t(79,"Select Section"),i(),I(80,Et,2,2,"option",30,N),i(),c(82,vt,2,1,"div",20),i()()()(),n(83,"div",33)(84,"div",15)(85,"div",16)(86,"label",34),t(87,"Building No. / Area of Locality / Street"),n(88,"span",18),t(89,"*"),i()(),C(90,"input",35),c(91,Nt,4,3,"div",20),i()(),n(92,"div",15)(93,"div",16)(94,"label",36),t(95,"Affiliation "),n(96,"span",18),t(97,"*"),i()(),n(98,"select",37)(99,"option",29),t(100,"Select Affiliation"),i(),n(101,"option",38),t(102,"ICSE"),i(),n(103,"option",39),t(104,"CBSE"),i()(),c(105,Dt,2,1,"div",20),i(),n(106,"div",16)(107,"label",40),t(108,"Year "),n(109,"span",18),t(110,"*"),i()(),C(111,"input",41),c(112,Mt,3,2,"div",20),i()(),n(113,"div",15)(114,"div",16)(115,"label",42),t(116,"Amount "),n(117,"span",18),t(118,"*"),i()(),C(119,"input",43),c(120,Ot,2,1,"div",20),i(),n(121,"div",16)(122,"label",44),t(123,"Route "),n(124,"span",18),t(125,"*"),i()(),n(126,"select",45)(127,"option",29),t(128,"Select Route"),i(),I(129,Tt,2,3,"option",30,N),i(),c(131,At,2,1,"div",20),i()(),n(132,"div",15)(133,"div",16)(134,"label",46),t(135,"Remarks"),i(),C(136,"input",47),i()()()(),n(137,"div",48)(138,"button",49),c(139,Lt,1,0,"span",50),t(140),i()()()()()),e&2&&(r(5),E("",d.studentId?"Edit":"Add"," Student"),r(13),E("",d.studentId?"Edit":"Add"," Student"),r(2),f("formGroup",d.addOrEditStudentForm),r(7),p(d.croppedBlogImage?-1:27),r(),p(d.croppedBlogImage?28:-1),r(9),p(d.addOrEditStudentForm.controls.fName.touched&&d.addOrEditStudentForm.controls.fName.invalid?37:-1),r(7),p(d.addOrEditStudentForm.controls.fatherName.touched&&d.addOrEditStudentForm.controls.fatherName.invalid?44:-1),r(8),p(d.addOrEditStudentForm.controls.phone.touched&&d.addOrEditStudentForm.controls.phone.invalid?52:-1),r(7),p(d.addOrEditStudentForm.controls.admissionNo.touched&&d.addOrEditStudentForm.controls.admissionNo.invalid?59:-1),r(10),D(d.classes),r(2),p(d.addOrEditStudentForm.controls.class.touched&&d.addOrEditStudentForm.controls.class.invalid?71:-1),r(9),D(d.sections),r(2),p(d.addOrEditStudentForm.controls.section.touched&&d.addOrEditStudentForm.controls.section.invalid?82:-1),r(9),p(d.addOrEditStudentForm.controls.address.touched&&d.addOrEditStudentForm.controls.address.invalid?91:-1),r(14),p(d.addOrEditStudentForm.controls.affiliation.touched&&d.addOrEditStudentForm.controls.affiliation.invalid?105:-1),r(7),p(d.addOrEditStudentForm.controls.year.touched&&d.addOrEditStudentForm.controls.year.invalid?112:-1),r(8),p(d.addOrEditStudentForm.controls.amount.touched&&d.addOrEditStudentForm.controls.amount.invalid?120:-1),r(9),D(d.routes),r(2),p(d.addOrEditStudentForm.controls.routeId.touched&&d.addOrEditStudentForm.controls.routeId.invalid?131:-1),r(7),f("disabled",d.isLoading),r(),p(d.isLoading?139:-1),r(),E(" ",d.isLoading?"Submitting...":"Submit"," "))},dependencies:[q,R,G,z,k,Z,A,L,Le,Re,B,V,w,U,H],encapsulation:2})};var Bt=["class","component"],Vt=()=>[10,20,30,50];function Gt(a,o){a&1&&(n(0,"div",9),C(1,"app-loading-page"),i())}function zt(a,o){if(a&1&&(n(0,"div",10),C(1,"app-error-page",11),i()),a&2){let e=u();r(),f("errorData",e.errorData)}}function qt(a,o){if(a&1){let e=P();n(0,"tr")(1,"td"),t(2),i(),n(3,"td"),t(4),i(),n(5,"td"),t(6),i(),n(7,"td"),t(8),i(),n(9,"td"),t(10),i(),n(11,"td"),t(12),i(),n(13,"td"),t(14),i(),n(15,"td"),t(16),ce(17,"date"),i(),n(18,"td")(19,"button",18),_("click",function(){let l=x(e).$implicit,g=u(2);return v(g.navigateToReceipt(l,l,(l.term??0)-1))}),t(20," Fees Receipt "),i()()()}if(a&2){let e=o.$implicit,d=o.$index,l=u(2);r(2),S(l.pageNumber*l.pageSize+d+1),r(2),y("",e.fName," ",e.lName),r(2),S(e.admissionNo),r(2),S(e.phone),r(2),S(e.paidMode),r(2),E("\u20B9",e.amount),r(2),S("Term "+e.term),r(2),S(pe(17,9,e.paidDate,"dd-MM-yyyy"))}}function $t(a,o){if(a&1&&(n(0,"option",21),t(1),i()),a&2){let e=o.$implicit;f("value",e),r(),E(" ",e," ")}}function jt(a,o){if(a&1){let e=P();n(0,"div",14)(1,"div",19)(2,"label"),t(3,"Items per page:"),i(),n(4,"select",20),_("change",function(l){x(e);let g=u(2);return v(g.onPageSizeChange(l))}),I(5,$t,2,2,"option",21,N),i(),n(7,"span"),t(8),i(),n(9,"button",22),_("click",function(){x(e);let l=u(2);return v(l.goToFirstPage())}),t(10," \xAB "),i(),n(11,"button",22),_("click",function(){x(e);let l=u(2);return v(l.goToPreviousPage())}),t(12," \u2039 "),i(),n(13,"button",22),_("click",function(){x(e);let l=u(2);return v(l.goToNextPage())}),t(14," \u203A "),i(),n(15,"button",22),_("click",function(){x(e);let l=u(2);return v(l.goToLastPage())}),t(16," \xBB "),i()()()}if(a&2){let e=u(2);r(4),f("value",e.pageSize),r(),D(K(8,Vt)),r(3),J("",e.pageNumber*e.pageSize+1," - ",e.getEndItemIndex()," of ",e.totalRecords),r(),f("disabled",e.pageNumber===0),r(2),f("disabled",e.pageNumber===0),r(2),f("disabled",e.pageNumber+1>=e.totalPages),r(2),f("disabled",e.pageNumber+1>=e.totalPages)}}function Ht(a,o){a&1&&C(0,"span",17)}function Ut(a,o){if(a&1){let e=P();n(0,"div",12)(1,"table",13)(2,"thead")(3,"tr")(4,"th"),t(5,"Sl.No"),i(),n(6,"th"),t(7,"Name"),i(),n(8,"th"),t(9,"Admission No"),i(),n(10,"th"),t(11,"Phone No"),i(),n(12,"th"),t(13,"Paid Mode"),i(),n(14,"th"),t(15,"Paid Amount"),i(),n(16,"th"),t(17,"Term"),i(),n(18,"th"),t(19,"Paid Date"),i(),n(20,"th"),t(21,"Action"),i()()(),n(22,"tbody"),I(23,qt,21,12,"tr",null,N),i()()(),c(25,jt,17,9,"div",14),n(26,"div",15)(27,"button",16),_("click",function(){x(e);let l=u();return v(l.exportExcel())}),c(28,Ht,1,0,"span",17),t(29),i()()}if(a&2){let e=u();r(23),D(e.studentsFees),r(2),p(e.totalRecords>e.pageSize?25:-1),r(2),f("disabled",e.isExportingExcelData),r(),p(e.isExportingExcelData?28:-1),r(),E(" ",e.isExportingExcelData?"Exporting...":"Export Excel"," ")}}var xe=class a{constructor(o,e,d,l,g){this._studentService=o;this._authService=e;this._router=d;this._snackBar=l;this._generateExcelService=g}paginatorForm=new O({pageNumber:new b(0),pageSize:new b(10)});filterForm=new O({searchString:new b(null)});isLoading=!1;isLoadingData=!0;isError=!1;errorData;totalRecords=0;isExportingExcelData=!1;selectedStudent=null;selectedFee=null;selectedFeeIndex=null;studentsFees=[];ngOnInit(){this.getStudentsData(),this.paginatorForm.valueChanges.pipe(j(500)).subscribe(o=>{this.isLoadingData=!0,this.getStudentsData()}),this.filterForm.valueChanges.pipe(j(500)).subscribe(o=>{this.isLoadingData=!0,this.getStudentsData()})}get pageNumber(){return this.paginatorForm.get("pageNumber")?.value??0}get pageSize(){return this.paginatorForm.get("pageSize")?.value??10}get totalPages(){return Math.ceil(this.totalRecords/this.pageSize)}getEndItemIndex(){let o=(this.pageNumber+1)*this.pageSize;return o>this.totalRecords?this.totalRecords:o}goToFirstPage(){this.paginatorForm.patchValue({pageNumber:0})}goToPreviousPage(){this.pageNumber>0&&this.paginatorForm.patchValue({pageNumber:this.pageNumber-1})}goToNextPage(){this.pageNumber+1<this.totalPages&&this.paginatorForm.patchValue({pageNumber:this.pageNumber+1})}goToLastPage(){this.paginatorForm.patchValue({pageNumber:this.totalPages-1})}onPageSizeChange(o){let e=parseInt(o.target.value,10);this.paginatorForm.patchValue({pageSize:e,pageNumber:0})}getStudentsData(){let o={pageIndex:this.pageNumber,pageSize:this.pageSize,searchString:this.filterForm.value.searchString||""};this.isError=!1,this.errorData=null,this.isLoadingData=!0,this._studentService.apiStudentGetStudentFeesPost(o).subscribe({next:e=>{this.isLoadingData=!1,e.statusCode===200&&e.data?(this.isError=!1,this.studentsFees=e.data,this.totalRecords=e.totalRecords??0):(this.isError=!0,this.errorData={imgSrc:"empty-box.png",errorTitleMessage:"No Data available",errorSubTitleMessage:"Please try to add Applicants!"})},error:e=>{this.isLoadingData=!1,this.studentsFees=[],navigator.onLine?e.status===401?this._authService.logout():this.setGenericError():this.errorData={imgSrc:"no-signal.png",errorTitleMessage:"Internet connection lost",errorSubTitleMessage:"Please check your connection."},this.isError=!0}})}setGenericError(){this.errorData={imgSrc:"error.png",errorTitleMessage:"Something went wrong",errorSubTitleMessage:"Please try again later"}}resetToSearch(){this.filterForm.controls.searchString.reset()}navigateToReceipt(o,e,d){this._router.navigate(["/admin/students/fee-receipt"],{state:{student:o,fee:e,feeIndex:d,backRoute:"/admin/students/fee-history"}})}exportExcel(){let o={pageIndex:this.pageNumber,pageSize:this.pageSize,searchString:this.filterForm.value.searchString||""};this.totalRecords>this.studentsFees.length?(this.isExportingExcelData=!0,this._studentService.apiStudentGetStudentFeesPost(o).subscribe({next:e=>{this.isExportingExcelData=!1,this.formatDownExcelData(e.data??[])},error:()=>{this.isExportingExcelData=!1,this._snackBar.open("Failed to export data. Please try again later.","Close",{duration:3e3,panelClass:["snack-error"]})}})):this.formatDownExcelData(this.studentsFees)}formatDownExcelData(o){let e=(o??[]).map(l=>se(le({},l),{term:`Term ${l.term??1}`,paidDate:new Date(l.paidDate??"").getDate().toString().padStart(2,"0")+"-"+(new Date(l.paidDate??"").getMonth()+1).toString().padStart(2,"0")+"-"+new Date(l.paidDate??"").getFullYear()})),d=[{header:"Admission No",selector:l=>l.admissionNo},{header:"Student Name",selector:l=>l.fName},{header:"Class",selector:l=>l.class},{header:"Section",selector:l=>l.section??""},{header:"Phone No",selector:l=>l.phone??""},{header:"Payment Mode",selector:l=>l.paidMode??""},{header:"Paid Amount",selector:l=>l.amount??""},{header:"Term",selector:l=>l.term??""},{header:"Payment Date",selector:l=>l.paidDate??""}];this._generateExcelService.downloadJsonAsXlsx({rows:e,columns:d,fileName:"Students_Fee_Data",sheetName:"Students Fee History"})}static \u0275fac=function(e){return new(e||a)(h($),h(Y),h(T),h(W),h(Se))};static \u0275cmp=M({type:a,selectors:[["app-list",8,"component"]],attrs:Bt,decls:19,vars:4,consts:[[1,"main-container"],[1,"header"],[1,"header-left"],[1,"page-title"],[1,"breadcrumb"],["routerLink","/admin/dashboard"],[1,"separator"],[1,"header-right",3,"formGroup"],["type","text","placeholder","Search...","formControlName","searchString",1,"search-input"],["fxLayoutAlign","center center",1,"loading-page-ui"],[1,"error-page-ui"],[3,"errorData"],[1,"table-wrapper"],[1,"table-ui"],[1,"paginator-wrapper"],[1,"form-actions"],[1,"submit",3,"click","disabled"],[1,"spinner"],[1,"edit-button",3,"click"],[1,"pagination-controls"],[3,"change","value"],[3,"value"],[3,"click","disabled"]],template:function(e,d){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),t(5,"Students Fees"),i()(),n(6,"div",4)(7,"span")(8,"a",5),t(9,"Home"),i()(),n(10,"span",6),t(11,"/"),i(),n(12,"span"),t(13,"Students Fees"),i()()(),n(14,"form",7),C(15,"input",8),i()(),c(16,Gt,2,0,"div",9),c(17,zt,2,1,"div",10),c(18,Ut,30,4),i()),e&2&&(r(14),f("formGroup",d.filterForm),r(2),p(d.isLoadingData&&!d.isError?16:-1),r(),p(!d.isLoadingData&&d.isError?17:-1),r(),p(!d.isLoadingData&&!d.isError?18:-1))},dependencies:[w,U,H,ee,Q,q,R,G,z,k,A,L,B,V,ue],encapsulation:2})};function Yt(a,o){a&1&&(n(0,"div",9),t(1,"Payment mode is required."),i())}function Wt(a,o){a&1&&(n(0,"div"),t(1,"Amount is required."),i())}function Jt(a,o){a&1&&(n(0,"div"),t(1,"Amount must be at least \u20B91"),i())}function Kt(a,o){if(a&1&&(n(0,"div",9),c(1,Wt,2,0,"div"),c(2,Jt,2,0,"div"),i()),a&2){let e=u();r(),p(e.form.amount.errors.required?1:-1),r(),p(e.form.amount.errors.pattern?2:-1)}}function Xt(a,o){a&1&&(n(0,"div",9),t(1,"Paid date is required."),i())}function Zt(a,o){a&1&&C(0,"span",17)}var ve=class a{constructor(o,e,d,l,g){this.fb=o;this.dialogRef=e;this.data=d;this.studentService=l;this.snackBar=g}addStudentFees;isLoading=!1;ngOnInit(){this.addStudentFees=this.fb.group({amount:["",[F.required,F.min(1)]],paidDate:["",F.required],paidMode:["",F.required]})}get form(){return this.addStudentFees.controls}onCancel(){this.dialogRef.close()}onSubmit(){if(this.addStudentFees.invalid){this.snackBar.open("Please fill in all required fields correctly","Close",{duration:3e3,panelClass:["snack-error"]}),this.addStudentFees.markAllAsTouched();return}let o=this.addStudentFees.value,e={studentId:this.data.studentId,paidMode:o.paidMode,amount:o.amount,paidDate:o.paidDate,comment:""};this.isLoading=!0,this.addStudentFees.disable(),this.studentService.apiStudentAddStudentFeePost(e).subscribe({next:d=>{this.isLoading=!1,this.addStudentFees.enable(),d.statusCode===200?(this.snackBar.open("Fee added successfully","Close",{duration:3e3,panelClass:["snack-success"]}),this.dialogRef.close(!0)):this.snackBar.open(d.message??"Failed to add fee","Close",{duration:3e3,panelClass:["snack-error"]})},error:()=>{this.isLoading=!1,this.addStudentFees.enable(),this.snackBar.open("Something went wrong","Close",{duration:3e3,panelClass:["snack-error"]})}})}static \u0275fac=function(e){return new(e||a)(h(Be),h(Ve),h(Ge),h($),h(W))};static \u0275cmp=M({type:a,selectors:[["app-take-fees-dialog"]],decls:32,vars:7,consts:[[1,"modal-form",3,"ngSubmit","formGroup"],[1,"form-group"],["for","paymentMode"],["id","paymentMode","formControlName","paidMode"],["value",""],["value","Cash"],["value","Card"],["value","UPI"],["value","Cheque"],[1,"date-hint"],["for","amount"],["type","number","id","amount","formControlName","amount","min","1"],["for","paiddate"],["type","date","id","paiddate","formControlName","paidDate"],[1,"actions"],["type","button",1,"btn","btn-stroke",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"spinner"]],template:function(e,d){e&1&&(n(0,"form",0),_("ngSubmit",function(){return d.onSubmit()}),n(1,"div",1)(2,"label",2),t(3,"Payment Mode"),i(),n(4,"select",3)(5,"option",4),t(6,"-- Select Payment Mode --"),i(),n(7,"option",5),t(8,"Cash"),i(),n(9,"option",6),t(10,"Card"),i(),n(11,"option",7),t(12,"UPI"),i(),n(13,"option",8),t(14,"Cheque"),i()(),c(15,Yt,2,0,"div",9),i(),n(16,"div",1)(17,"label",10),t(18,"Fees Amount"),i(),C(19,"input",11),c(20,Kt,3,2,"div",9),i(),n(21,"div",1)(22,"label",12),t(23,"Date"),i(),C(24,"input",13),c(25,Xt,2,0,"div",9),i(),n(26,"div",14)(27,"button",15),_("click",function(){return d.onCancel()}),t(28," Close "),i(),n(29,"button",16),c(30,Zt,1,0,"span",17),t(31),i()()()),e&2&&(f("formGroup",d.addStudentFees),r(15),p(d.form.paidMode.touched&&(d.form.paidMode.errors!=null&&d.form.paidMode.errors.required)?15:-1),r(5),p(d.form.amount.touched&&d.form.amount.errors?20:-1),r(5),p(d.form.paidDate.touched&&(d.form.paidDate.errors!=null&&d.form.paidDate.errors.required)?25:-1),r(4),f("disabled",d.isLoading),r(),p(d.isLoading?30:-1),r(),E(" ",d.isLoading?"Submitting...":"Submit"," "))},dependencies:[q,R,G,z,k,ke,Z,A,L,Ae,B,V,w],styles:["[_nghost-%COMP%]{display:block;background:#fff;border-radius:12px;padding:24px;width:460px;margin:0 auto;box-shadow:0 10px 30px #0000001f;box-sizing:border-box;font-family:Segoe UI,sans-serif}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding-bottom:10px;border-bottom:1px solid #e0e0e0}.modal-title[_ngcontent-%COMP%]{font-size:1.4rem;font-weight:600;margin:0}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:1.5rem;cursor:pointer;color:#333}.modal-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}label[_ngcontent-%COMP%]{font-weight:500;margin-bottom:6px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:10px;border:1px solid #ccc;border-radius:6px;background-color:#fafafa;font-size:1rem}input[type=date][_ngcontent-%COMP%]{font-family:inherit}.date-hint[_ngcontent-%COMP%]{color:#e74c3c;font-size:.82rem;font-weight:400;margin-left:4px}.actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:14px;margin-top:28px}.btn[_ngcontent-%COMP%]{min-width:100px;font-weight:500;font-size:.95rem;border-radius:6px;text-transform:none;padding:6px 16px;cursor:pointer}.btn-primary[_ngcontent-%COMP%]{background-color:#2196f3;color:#fff;border:none}.btn-stroke[_ngcontent-%COMP%]{background-color:transparent;color:#f44336;border:1px solid #f44336}"]})};var Qt=["class","component"],ei=()=>[10,20,30,50];function ti(a,o){if(a&1){let e=P();n(0,"button",14),_("click",function(){let l=x(e).$implicit,g=u();return v(g.openDialog(l.studentId))}),t(1),i()}if(a&2){let e=o.$implicit;f("disabled",((e==null?null:e.due)??0)<=0),r(),E(" ",((e==null?null:e.due)??0)<=0?"No Due Payment":"Collect Fee"," ")}}function ii(a,o){a&1&&(n(0,"div",11),C(1,"app-loading-page"),i())}function ni(a,o){if(a&1&&(n(0,"div",12),C(1,"app-error-page",15),i()),a&2){let e=u();r(),f("errorData",e.errorData)}}function oi(a,o){if(a&1&&(n(0,"div",19)(1,"p")(2,"strong"),t(3,"Name: "),i(),t(4),i(),n(5,"p")(6,"strong"),t(7,"Father Name: "),i(),t(8),i(),n(9,"p")(10,"strong"),t(11,"Phone No: "),i(),t(12),i(),n(13,"div",20)(14,"p")(15,"strong"),t(16,"Total Fee: "),i(),t(17),i(),n(18,"p")(19,"strong"),t(20,"Paid Fee: "),i(),t(21),i(),n(22,"p")(23,"strong"),t(24,"Due Fee: "),i(),t(25),i()()()),a&2){let e=o.$implicit;r(4),y("",e.fName," ",e.lName),r(4),E("",e.fatherName,","),r(4),S(e.phone),r(5),E("\u20B9",e.totalAmount,","),r(4),E("\u20B9",e.paid,","),r(4),E("\u20B9",e.due)}}function ai(a,o){if(a&1){let e=P();n(0,"tr")(1,"td"),t(2),i(),n(3,"td"),t(4),i(),n(5,"td"),t(6),i(),n(7,"td"),t(8),i(),n(9,"td"),t(10),i(),n(11,"td"),t(12),i(),n(13,"td"),t(14),i(),n(15,"td"),t(16),ce(17,"date"),i(),n(18,"td")(19,"button",21),_("click",function(){let l=x(e),g=l.$implicit,Fe=l.$index,Ne=u().$implicit,we=u(2);return v(we.navigateToReceipt(Ne,g,Fe))}),t(20," Fee Receipt "),i()()()}if(a&2){let e=o.$implicit,d=o.$index,l=u().$implicit;r(2),S(d+1),r(2),y("",l.fName," ",l.lName),r(2),S(l.admissionNo),r(2),S(l.phone),r(2),S(e.paidMode),r(2),E("\u20B9",e.amount),r(2),S("Term "+(d+1)),r(2),S(pe(17,9,e.paidDate,"dd-MM-yyyy"))}}function ri(a,o){if(a&1&&(ne(0),I(1,ai,21,12,"tr",null,N),oe()),a&2){let e=o.$implicit;r(),D(e.fees)}}function di(a,o){if(a&1&&(Ie(0,oi,26,7,"div",16),n(1,"div",17)(2,"table",18)(3,"thead")(4,"tr")(5,"th"),t(6,"Sl.No"),i(),n(7,"th"),t(8,"Name"),i(),n(9,"th"),t(10,"Admission No"),i(),n(11,"th"),t(12,"Phone No"),i(),n(13,"th"),t(14,"Paid Mode"),i(),n(15,"th"),t(16,"Paid Amount"),i(),n(17,"th"),t(18,"Term"),i(),n(19,"th"),t(20,"Paid Date"),i(),n(21,"th"),t(22,"Action"),i()()(),n(23,"tbody"),I(24,ri,3,0,"ng-container",null,N),i()()()),a&2){let e=u();f("ngForOf",e.studentsFees),r(24),D(e.studentsFees)}}function li(a,o){if(a&1&&(n(0,"option",24),t(1),i()),a&2){let e=o.$implicit;f("value",e),r(),E(" ",e," ")}}function si(a,o){if(a&1){let e=P();n(0,"div",13)(1,"div",22)(2,"label"),t(3,"Items per page:"),i(),n(4,"select",23),_("change",function(l){x(e);let g=u();return v(g.onPageSizeChange(l))}),I(5,li,2,2,"option",24,N),i(),n(7,"span"),t(8),i(),n(9,"button",25),_("click",function(){x(e);let l=u();return v(l.goToFirstPage())}),t(10," \xAB "),i(),n(11,"button",25),_("click",function(){x(e);let l=u();return v(l.goToPreviousPage())}),t(12," \u2039 "),i(),n(13,"button",25),_("click",function(){x(e);let l=u();return v(l.goToNextPage())}),t(14," \u203A "),i(),n(15,"button",25),_("click",function(){x(e);let l=u();return v(l.goToLastPage())}),t(16," \xBB "),i()()()}if(a&2){let e=u();r(4),f("value",e.pageSize),r(),D(K(8,ei)),r(3),J("",e.pageNumber*e.pageSize+1," - ",e.getEndItemIndex()," of ",e.totalRecords),r(),f("disabled",e.pageNumber===0),r(2),f("disabled",e.pageNumber===0),r(2),f("disabled",e.pageNumber+1>=e.totalPages),r(2),f("disabled",e.pageNumber+1>=e.totalPages)}}var Ce=class a{constructor(o,e,d,l,g){this._studentService=o;this._authService=e;this._route=d;this._router=l;this._dialog=g}paginatorForm=new O({pageNumber:new b(0),pageSize:new b(10)});filterForm=new O({searchString:new b(null),studentId:new b(null)});isLoading=!1;isLoadingData=!0;isError=!1;errorData;totalRecords=0;studentsFees=[];selectedStudent=null;selectedFee=null;selectedFeeIndex=null;ngOnInit(){this._route.queryParams.subscribe(o=>{let e=o.studentId;e&&this.filterForm.patchValue({studentId:e}),this.getStudentsData()}),this.getStudentsData(),this.paginatorForm.valueChanges.pipe(j(500)).subscribe(o=>{this.isLoadingData=!0,this.getStudentsData()}),this.filterForm.valueChanges.pipe(j(500)).subscribe(o=>{this.isLoadingData=!0,this.getStudentsData()})}get pageNumber(){return this.paginatorForm.get("pageNumber")?.value??0}get pageSize(){return this.paginatorForm.get("pageSize")?.value??10}get totalPages(){return Math.ceil(this.totalRecords/this.pageSize)}getEndItemIndex(){let o=(this.pageNumber+1)*this.pageSize;return o>this.totalRecords?this.totalRecords:o}goToFirstPage(){this.paginatorForm.patchValue({pageNumber:0})}goToPreviousPage(){this.pageNumber>0&&this.paginatorForm.patchValue({pageNumber:this.pageNumber-1})}goToNextPage(){this.pageNumber+1<this.totalPages&&this.paginatorForm.patchValue({pageNumber:this.pageNumber+1})}goToLastPage(){this.paginatorForm.patchValue({pageNumber:this.totalPages-1})}onPageSizeChange(o){let e=parseInt(o.target.value,10);this.paginatorForm.patchValue({pageSize:e,pageNumber:0})}getStudentsData(){let o={pageIndex:this.pageNumber,pageSize:this.pageSize,searchString:this.filterForm.value.searchString||"",studentId:this.filterForm.value.studentId||null};this.isError=!1,this.errorData=null,this.isLoadingData=!0,this._studentService.apiStudentGetStudentFeesWithDetailsPost(o).subscribe({next:e=>{this.isLoadingData=!1,e.statusCode===200&&e.data?(this.isError=!1,this.studentsFees=e.data,this.totalRecords=e.totalRecords??0):(this.isError=!0,this.errorData={imgSrc:"empty-box.png",errorTitleMessage:"No Data available",errorSubTitleMessage:"Please try to add Applicants!"})},error:e=>{this.isLoadingData=!1,this.studentsFees=[],navigator.onLine?e.status===401?this._authService.logout():this.setGenericError():this.errorData={imgSrc:"no-signal.png",errorTitleMessage:"Internet connection lost",errorSubTitleMessage:"Please check your connection."},this.isError=!0}})}setGenericError(){this.errorData={imgSrc:"error.png",errorTitleMessage:"Something went wrong",errorSubTitleMessage:"Please try again later"}}resetToSearch(){this.filterForm.controls.searchString.reset()}openDialog(o){this._dialog.open(ve,{data:{studentId:o}}).afterClosed().subscribe(d=>{d&&this.getStudentsData()})}navigateToReceipt(o,e,d){this._router.navigate(["/admin/students/fee-receipt"],{state:{student:o,fee:e,feeIndex:d,backRoute:`/admin/students/fee-list?studentId=${o.studentId}`}})}static \u0275fac=function(e){return new(e||a)(h($),h(Y),h(X),h(T),h(te))};static \u0275cmp=M({type:a,selectors:[["app-list",8,"component"]],attrs:Qt,decls:26,vars:6,consts:[[1,"main-container"],[1,"header"],[1,"header-left"],[1,"page-title"],[1,"breadcrumb"],["routerLink","/admin/dashboard"],[1,"separator"],["routerLink","/admin/students/list"],[1,"header-right",3,"formGroup"],["type","text","placeholder","Search...","formControlName","searchString",1,"search-input"],["class","add-button",3,"disabled","click",4,"ngFor","ngForOf"],["fxLayoutAlign","center center",1,"loading-page-ui"],[1,"error-page-ui"],[1,"paginator-wrapper"],[1,"add-button",3,"click","disabled"],[3,"errorData"],["class","student-details",4,"ngFor","ngForOf"],[1,"table-wrapper"],[1,"table-ui"],[1,"student-details"],[1,"one-line"],[1,"edit-button",3,"click"],[1,"pagination-controls"],[3,"change","value"],[3,"value"],[3,"click","disabled"]],template:function(e,d){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),t(5,"Student Details"),i()(),n(6,"div",4)(7,"span")(8,"a",5),t(9,"Home"),i()(),n(10,"span",6),t(11,"/"),i(),n(12,"span")(13,"a",7),t(14,"Students"),i()(),n(15,"span",6),t(16,"/"),i(),n(17,"span"),t(18,"Student Details"),i()()(),n(19,"form",8),C(20,"input",9),Ie(21,ti,2,2,"button",10),i()(),c(22,ii,2,0,"div",11),c(23,ni,2,1,"div",12),c(24,di,26,1),c(25,si,17,9,"div",13),i()),e&2&&(r(19),f("formGroup",d.filterForm),r(2),f("ngForOf",d.studentsFees),r(),p(d.isLoadingData&&!d.isError?22:-1),r(),p(!d.isLoadingData&&d.isError?23:-1),r(),p(!d.isLoadingData&&!d.isError?24:-1),r(),p(d.totalRecords>d.pageSize?25:-1))},dependencies:[w,Te,U,H,ee,Q,q,R,G,z,k,A,L,B,V,ue],styles:[".student-details[_ngcontent-%COMP%]{margin-top:10px}.student-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#333}.student-details[_ngcontent-%COMP%]   .one-line[_ngcontent-%COMP%]{display:flex;gap:5px}"]})};function mi(a,o){if(a&1&&(s(0,"div",9)(1,"div",10)(2,"div",11)(3,"h3"),t(4,"ST. ANTHONY'S ASSOCIATES MADINAGUDA"),m(),s(5,"p",12),t(6,"HYDERABAD, TELANGANA"),m(),s(7,"h2",13),t(8,"BUS FEE RECEIPT"),m()(),s(9,"div",14)(10,"div",15)(11,"table",16)(12,"tbody")(13,"tr")(14,"td"),t(15,"Admission No."),m(),s(16,"td",17),t(17),m(),s(18,"td"),t(19,"Mobile No."),m(),s(20,"td",17),t(21),m()(),s(22,"tr")(23,"td"),t(24,"Roll No."),m(),ie(25,"td",17),s(26,"td"),t(27,"Receipt No."),m(),s(28,"td",17),t(29),m()(),s(30,"tr")(31,"td"),t(32,"Student Name"),m(),s(33,"td",17),t(34),m(),s(35,"td"),t(36,"Date"),m(),s(37,"td",17),t(38),m()(),s(39,"tr")(40,"td"),t(41,"Father Name"),m(),s(42,"td",17),t(43),m(),s(44,"td"),t(45,"Payment Mode"),m(),s(46,"td",17),t(47),m()(),s(48,"tr")(49,"td"),t(50,"Class & Sec"),m(),s(51,"td",17),t(52),m(),s(53,"td"),t(54,"Transaction Id"),m(),s(55,"td",17),t(56),m()()()(),s(57,"table",18)(58,"thead")(59,"tr")(60,"td"),t(61,"Sl No."),m(),s(62,"td"),t(63,"Description"),m(),s(64,"td"),t(65,"Amount"),m()()(),s(66,"tbody")(67,"tr")(68,"td"),t(69),m(),s(70,"td"),t(71),m(),s(72,"td",17),t(73),m()(),s(74,"tr"),ie(75,"td"),s(76,"td",19),t(77,"Total"),m(),s(78,"td",17),t(79),m()()()()()(),s(80,"div")(81,"p")(82,"strong"),t(83,"Rupees in words: "),m(),s(84,"span"),t(85,"Nine Thousand Rupees Only"),m()(),s(86,"p",20)(87,"strong"),t(88,"Total Due Amount: "),m(),s(89,"span"),t(90),m()(),s(91,"p",21),t(92,"Signature of Received Staff"),m()()(),s(93,"div",10)(94,"div",11)(95,"h3"),t(96,"ST. ANTHONY'S ASSOCIATES MADINAGUDA"),m(),s(97,"p",12),t(98,"HYDERABAD, TELANGANA"),m(),s(99,"h2",13),t(100,"BUS FEE RECEIPT"),m()(),s(101,"div",14)(102,"div",15)(103,"table",16)(104,"tbody")(105,"tr")(106,"td"),t(107,"Admission No."),m(),s(108,"td",17),t(109),m(),s(110,"td"),t(111,"Mobile No."),m(),s(112,"td",17),t(113),m()(),s(114,"tr")(115,"td"),t(116,"Roll No."),m(),ie(117,"td",17),s(118,"td"),t(119,"Receipt No."),m(),s(120,"td",17),t(121),m()(),s(122,"tr")(123,"td"),t(124,"Student Name"),m(),s(125,"td",17),t(126),m(),s(127,"td"),t(128,"Date"),m(),s(129,"td",17),t(130),m()(),s(131,"tr")(132,"td"),t(133,"Father Name"),m(),s(134,"td",17),t(135),m(),s(136,"td"),t(137,"Payment Mode"),m(),s(138,"td",17),t(139),m()(),s(140,"tr")(141,"td"),t(142,"Class & Sec"),m(),s(143,"td",17),t(144),m(),s(145,"td"),t(146,"Transaction Id"),m(),s(147,"td",17),t(148),m()()()(),s(149,"table",18)(150,"thead")(151,"tr")(152,"th"),t(153,"Sl No."),m(),s(154,"th"),t(155,"Description"),m(),s(156,"th"),t(157,"Amount"),m()()(),s(158,"tbody")(159,"tr")(160,"td"),t(161),m(),s(162,"td"),t(163),m(),s(164,"td",17),t(165),m()(),s(166,"tr"),ie(167,"td"),s(168,"td",19),t(169,"Total"),m(),s(170,"td",17),t(171),m()()()()()(),s(172,"div")(173,"p",22)(174,"strong"),t(175,"Rupees in words: "),m(),s(176,"span"),t(177,"Nine Thousand Rupees Only"),m()(),s(178,"p",20)(179,"strong"),t(180,"Total Due Amount: "),m(),s(181,"span"),t(182),m()(),s(183,"p",21),t(184,"Signature of Received Staff"),m()()()()),a&2){let e=u();r(17),S(e.selectedStudent.admissionNo),r(4),S(e.selectedStudent.phone),r(8),S(e.selectedFee.id),r(5),y(" ",e.selectedStudent.fName," ",e.selectedStudent.lName," "),r(4),S(e.selectedFee.createdDate),r(5),S(e.selectedStudent.fatherName),r(4),S(e.selectedFee.paidMode),r(5),y(" ",e.selectedStudent.class," - ",e.selectedStudent.section," "),r(4),S(e.selectedFee.id),r(13),S(e.selectedFeeIndex+1),r(2),E("Term ",e.selectedFeeIndex+1),r(2),E("\u20B9",e.selectedFee.amount),r(6),E("\u20B9",e.selectedFee.amount),r(11),E("\u20B9",e.selectedStudent.due),r(19),S(e.selectedStudent.admissionNo),r(4),S(e.selectedStudent.phone),r(8),S(e.selectedFee.id),r(5),y(" ",e.selectedStudent.fName," ",e.selectedStudent.lName," "),r(4),S(e.selectedFee.createdDate),r(5),S(e.selectedStudent.fatherName),r(4),S(e.selectedFee.paidMode),r(5),y(" ",e.selectedStudent.class," - ",e.selectedStudent.section," "),r(4),S(e.selectedFee.id),r(13),S(e.selectedFeeIndex+1),r(2),E("Term ",e.selectedFeeIndex+1),r(2),E("\u20B9",e.selectedFee.amount),r(6),E("\u20B9",e.selectedFee.amount),r(11),E("\u20B9",e.selectedStudent.due)}}var be=class a{constructor(o){this.router=o}selectedStudent=null;selectedFee=null;selectedFeeIndex=null;backRoute="/admin/students/fee-history";ngOnInit(){let o=this.router.getCurrentNavigation()?.extras?.state||history.state;o&&o.student&&o.fee?(this.selectedStudent=o.student,this.selectedFee=o.fee,this.selectedFeeIndex=o.feeIndex??0,this.backRoute=o.backRoute||this.backRoute):this.router.navigateByUrl(this.backRoute),document.body.style.overflow="hidden"}goBack(){this.router.navigateByUrl(this.backRoute)}printReceipt(){let o=document.getElementById("printSection")?.innerHTML||"",e=window.open("","_blank","width=800,height=900");e&&(e.document.open(),e.document.write(`
      <html>
        <head>
          <title>Bus Fee Receipt</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            table { border-collapse: collapse; width: 100%; }
.receipt {
  border: 2px solid #253a5b;
  padding: 5px;
  margin-bottom: 19px;
  margin: 20px;
  box-sizing: border-box;

  .receipt-header {
    margin: 0;
    text-align: center;
    color: #253a5b;
    width: 100%;

    h3 {
      margin: 0;
      margin-top: 0;
      font-size: 18px;
      font-weight: 900;
      line-height: 30px;
    }

    .location {
      margin: 0;
      margin-top: 0;
      font-size: 15px;
      font-weight: 600;
    }

    .receipt-title {
      margin: 0;
      margin-top: 0;
      font-size: 15px;
      font-weight: 600;
    }
  }

  .tables {
    display: block;
    width: 100%;
    overflow-x: auto;
    margin-top: 6px;

    .table-scroll-wrapper {
      overflow-x: auto;

      .details-table {
        width: 100%;
        min-width: 600px; // \u2705 Minimum width for content to not break badly
        border-collapse: collapse;
        font-size: 0.95rem;

        td {
          border: 1px solid #8d8d8d;
          padding: 6px 10px;
          white-space: nowrap;
          font-weight: 600;
          color: #333;
        }

        .answer {
          font-size: 13px;
          font-weight: 400;
        }
      }

      .fee-table {
        width: 100%;
        min-width: 600px;
        border-collapse: collapse;
        font-size: 0.95rem;
        margin-top: 18px;

        th,
        td {
          border: 1px solid #8d8d8d;
          padding: 6px 10px;
          white-space: nowrap;
          font-weight: 600;
          color: #333;
        }
        .answer {
          font-size: 13px;
          font-weight: 400;
        }
      }
    }
  }

  .due-amount {
    text-align: end;
  }

  .staff-sign {
    margin-top: 40px;
    margin-right: 50px;
    margin-bottom: 0;
    text-align: end;
  }
}
          </style>
        </head>
        <body>
          ${o}
        </body>
      </html>
    `),e.document.close(),e.print())}backRouteLink(){this.router.navigateByUrl(this.backRoute)}onAfterPrint(){this.goBack()}convertToWords(o){if(!o)return"Zero";let e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],d=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],l=g=>g<20?e[g]:g<100?d[Math.floor(g/10)]+(g%10?" "+e[g%10]:""):g<1e3?e[Math.floor(g/100)]+" Hundred"+(g%100?" and "+l(g%100):""):g<1e5?l(Math.floor(g/1e3))+" Thousand"+(g%1e3?" "+l(g%1e3):""):g<1e7?l(Math.floor(g/1e5))+" Lakh"+(g%1e5?" "+l(g%1e5):""):l(Math.floor(g/1e7))+" Crore"+(g%1e7?" "+l(g%1e7):"");return l(Math.floor(o))}static \u0275fac=function(e){return new(e||a)(h(T))};static \u0275cmp=M({type:a,selectors:[["app-fee-receipt"]],hostBindings:function(e,d){e&1&&_("afterprint",function(){return d.onAfterPrint()},Oe)},decls:20,vars:1,consts:[[1,"main-container"],[1,"header"],[1,"header-left"],[1,"page-title"],[1,"breadcrumb"],["routerLink","/admin/dashboard"],[1,"separator"],[1,"header-right"],[1,"add-button",3,"click"],["id","printSection"],[1,"receipt"],[1,"receipt-header"],[1,"location"],[1,"receipt-title"],[1,"tables"],[1,"table-scroll-wrapper"],[1,"details-table"],[1,"answer"],[1,"fee-table"],[2,"text-align","end"],[1,"due-amount"],[1,"staff-sign"],[1,"rupees-in-words"]],template:function(e,d){e&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),t(5,"View Fee Receipt"),m()(),s(6,"div",4)(7,"span")(8,"a",5),t(9,"Home"),m()(),s(10,"span",6),t(11,"/"),m(),s(12,"span"),t(13,"View Fee Receipt"),m()()(),s(14,"div",7)(15,"button",8),De("click",function(){return d.backRouteLink()}),t(16,"Back"),m(),s(17,"button",8),De("click",function(){return d.printReceipt()}),t(18,"Print Receipt"),m()()(),c(19,mi,185,32,"div",9),m()),e&2&&(r(19),p(d.selectedStudent&&d.selectedFee&&d.selectedFeeIndex!==null?19:-1))},dependencies:[w],styles:[".receipt[_ngcontent-%COMP%]{border:2px solid #253a5b;padding:5px;margin:20px;box-sizing:border-box}.receipt[_ngcontent-%COMP%]   .receipt-header[_ngcontent-%COMP%]{margin:0;text-align:center;color:#253a5b;width:100%}.receipt[_ngcontent-%COMP%]   .receipt-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:900;line-height:30px}.receipt[_ngcontent-%COMP%]   .receipt-header[_ngcontent-%COMP%]   .location[_ngcontent-%COMP%], .receipt[_ngcontent-%COMP%]   .receipt-header[_ngcontent-%COMP%]   .receipt-title[_ngcontent-%COMP%]{margin:0;font-size:15px;font-weight:600}.receipt[_ngcontent-%COMP%]   .tables[_ngcontent-%COMP%]{display:block;width:100%;overflow-x:auto;margin-top:6px}.receipt[_ngcontent-%COMP%]   .tables[_ngcontent-%COMP%]   .table-scroll-wrapper[_ngcontent-%COMP%]{overflow-x:auto}.receipt[_ngcontent-%COMP%]   .tables[_ngcontent-%COMP%]   .table-scroll-wrapper[_ngcontent-%COMP%]   .details-table[_ngcontent-%COMP%]{width:100%;min-width:600px;border-collapse:collapse;font-size:.95rem}.receipt[_ngcontent-%COMP%]   .tables[_ngcontent-%COMP%]   .table-scroll-wrapper[_ngcontent-%COMP%]   .details-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #8d8d8d;padding:6px 10px;white-space:nowrap;font-weight:600;color:#333}.receipt[_ngcontent-%COMP%]   .tables[_ngcontent-%COMP%]   .table-scroll-wrapper[_ngcontent-%COMP%]   .details-table[_ngcontent-%COMP%]   .answer[_ngcontent-%COMP%]{font-size:13px;font-weight:400}.receipt[_ngcontent-%COMP%]   .tables[_ngcontent-%COMP%]   .table-scroll-wrapper[_ngcontent-%COMP%]   .fee-table[_ngcontent-%COMP%]{width:100%;min-width:600px;border-collapse:collapse;font-size:.95rem;margin-top:18px}.receipt[_ngcontent-%COMP%]   .tables[_ngcontent-%COMP%]   .table-scroll-wrapper[_ngcontent-%COMP%]   .fee-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .receipt[_ngcontent-%COMP%]   .tables[_ngcontent-%COMP%]   .table-scroll-wrapper[_ngcontent-%COMP%]   .fee-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #8d8d8d;padding:6px 10px;white-space:nowrap;font-weight:600;color:#333}.receipt[_ngcontent-%COMP%]   .tables[_ngcontent-%COMP%]   .table-scroll-wrapper[_ngcontent-%COMP%]   .fee-table[_ngcontent-%COMP%]   .answer[_ngcontent-%COMP%]{font-size:13px;font-weight:400}.receipt[_ngcontent-%COMP%]   .due-amount[_ngcontent-%COMP%]{text-align:end}.receipt[_ngcontent-%COMP%]   .staff-sign[_ngcontent-%COMP%]{margin-top:40px;margin-right:50px;margin-bottom:0;text-align:end}"]})};var un=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:fe},{path:"add",component:de},{path:"edit",component:de},{path:"fee-history",component:xe},{path:"fee-list",component:Ce},{path:"fee-receipt",component:be}];export{un as studentsRoutes};
