import{a as $}from"./chunk-J35TZ3AM.js";import{A as W,b as N,d as h,e as j,f as z,g as B,h as I,i as U,k as q,n as G,v as V}from"./chunk-L7HYSWOG.js";import{a as J,i as Y,j as Z}from"./chunk-DZGCCUOH.js";import{g as K}from"./chunk-FDP5VDWE.js";import"./chunk-LCCYGYQT.js";import{Aa as l,Ba as p,Bb as O,Db as A,Fa as f,Ga as i,H as S,Ha as a,Ia as m,Ib as F,Jb as T,K as w,Kb as L,M as P,Nb as R,Ob as D,Pb as E,Qa as b,Sa as x,Sb as H,Ub as d,W as M,ab as s,cb as y,ha as r,la as c,lb as k,oa as g}from"./chunk-M53X7M2I.js";var C=class t{constructor(n){this._authenticationService=n}intercept(n,e){let o=this._authenticationService.getToken();if(o){let u=n.clone({setHeaders:{Authorization:`Bearer ${o}`}});return e.handle(u)}return e.handle(n)}static \u0275fac=function(e){return new(e||t)(w(d))};static \u0275prov=S({token:t,factory:t.\u0275fac})};function oe(t,n){t&1&&(i(0,"span"),s(1,"Email is required."),a())}function ie(t,n){t&1&&(i(0,"span"),s(1,"Please enter a valid email address."),a())}function re(t,n){if(t&1&&(i(0,"div",8),l(1,oe,2,0,"span"),l(2,ie,2,0,"span"),a()),t&2){let e=x();r(),p(e.signInForm.controls.emailId.errors!=null&&e.signInForm.controls.emailId.errors.required?1:-1),r(),p(e.signInForm.controls.emailId.errors!=null&&e.signInForm.controls.emailId.errors.email?2:-1)}}function ae(t,n){t&1&&m(0,"i",13)}function se(t,n){t&1&&m(0,"i",14)}function ce(t,n){t&1&&(i(0,"span"),s(1,"Password is required."),a())}function le(t,n){if(t&1&&(i(0,"div",8),l(1,ce,2,0,"span"),a()),t&2){let e=x();r(),p(e.signInForm.controls.password.errors!=null&&e.signInForm.controls.password.errors.required?1:-1)}}function pe(t,n){t&1&&m(0,"span",16)}var v=class t{constructor(n,e,o,u,me){this._route=n;this._authenticationService=e;this._router=o;this._accountsService=u;this._snackBar=me}signInForm=new B({emailId:new I(null,[h.required,h.email]),password:new I(null,[h.required])});isLoading=!1;userDate;returnUrl;userData;showPassword=!1;togglePasswordVisibility(){this.showPassword=!this.showPassword}ngOnInit(){let n=this._route.snapshot.queryParams.returnUrl;n&&(this.returnUrl=window.atob(n)),this._authenticationService._loginListener.subscribe(e=>{e&&this._authenticationService.isAdminLogin&&(this.returnUrl?this._router.navigateByUrl(this.returnUrl):this._router.navigate(["/admin/dashboard"]))}),this._authenticationService.handleUserAuthentication()}onSubmit(){if(this.signInForm.invalid){this.signInForm.markAllAsTouched();return}this.isLoading=!0,this.signInForm.disable();let n={email:this.signInForm.controls.emailId.value?.trim(),password:this.signInForm.controls.password.value?.trim(),roleId:1};this._accountsService.apiAccountsLoginPost(n).subscribe({next:e=>{this.isLoading=!1,this.signInForm.enable(),localStorage.removeItem("userData"),e.statusCode===200&&e.data?(this.setupAuth(e.data),this._snackBar.open(e.message??"Logged in successfully","Close",{duration:3e3,panelClass:["snack-success"]})):this._snackBar.open(e.message??"Login failed","Close",{duration:3e3,panelClass:["snack-error"]})},error:e=>{console.error("Login error:",e),this.isLoading=!1,this.signInForm.enable();let o=navigator.onLine?"Something went wrong. Please try again later.":"Internet Connection Lost. Please check your connectivity.";this._snackBar.open(o,"Close",{duration:4e3,panelClass:["snack-error"]})}})}setupAuth(n){if(n&&n.expiresIn){localStorage.removeItem("userData"),this.userData=n,this.userData.expiresIn=new Date().getTime()+n?.expiresIn*1e3;let e={accessToken:this.userData.accessToken,expiresIn:this.userData.expiresIn,refreshToken:this.userData.refreshToken,tokenType:this.userData.tokenType,name:this.userData.userName,role:this.userData.roles};localStorage.setItem("userData",JSON.stringify(e)),this._authenticationService.handleUserAuthentication()}}static \u0275fac=function(e){return new(e||t)(c(R),c(d),c(E),c(J),c(W))};static \u0275cmp=g({type:t,selectors:[["app-sign-in"]],decls:23,vars:8,consts:[[1,"container"],[1,"right-section"],[1,"form-container"],[1,"subtitle"],[1,"title"],[1,"form-group-container",3,"ngSubmit","formGroup"],["for","email"],["type","email","id","email","formControlName","emailId","placeholder","Enter your email"],[1,"error"],["for","password"],[1,"password-wrapper"],["id","password","formControlName","password","placeholder","Enter your password",3,"type"],[1,"toggle-icon",3,"click"],[1,"fa","fa-eye-slash"],[1,"fa","fa-eye"],["type","submit",1,"submit",3,"disabled"],[1,"spinner"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),s(4,"Sign In"),a(),i(5,"h1",4),s(6,"St. Anthony's Associates"),a(),i(7,"form",5),b("ngSubmit",function(){return o.onSubmit()}),i(8,"label",6),s(9,"Your Email Address"),a(),m(10,"input",7),l(11,re,3,2,"div",8),i(12,"label",9),s(13,"Password"),a(),i(14,"div",10),m(15,"input",11),i(16,"span",12),b("click",function(){return o.togglePasswordVisibility()}),l(17,ae,1,0,"i",13)(18,se,1,0,"i",14),a()(),l(19,le,2,1,"div",8),i(20,"button",15),l(21,pe,1,0,"span",16),s(22),a()()()()()),e&2&&(r(7),f("formGroup",o.signInForm),r(4),p(o.signInForm.controls.emailId.touched&&o.signInForm.controls.emailId.invalid?11:-1),r(4),f("type",o.showPassword?"text":"password"),r(2),p(o.showPassword?17:18),r(2),p(o.signInForm.controls.password.touched&&o.signInForm.controls.password.invalid?19:-1),r(),f("disabled",o.isLoading),r(),p(o.isLoading?21:-1),r(),y(" ",o.isLoading?"Please wait...":"Sign in"," "))},dependencies:[O,V,U,N,j,z,q,G],styles:["*[_ngcontent-%COMP%]{box-sizing:border-box}html[_ngcontent-%COMP%], body[_ngcontent-%COMP%]{height:100%;margin:0;padding:0;background-color:#f5f5f5}.container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#eef5f9}.right-section[_ngcontent-%COMP%]{width:100%;max-width:440px;background-color:#fff;border-radius:8px;padding:40px 30px;box-shadow:0 4px 12px #00000014}.form-container[_ngcontent-%COMP%]{width:100%}.subtitle[_ngcontent-%COMP%]{color:#5c4ac7;font-weight:500;font-size:15px;margin-bottom:0;text-align:center}.title[_ngcontent-%COMP%]{font-size:22px;font-weight:600;margin-top:4px;margin-bottom:24px;text-align:center;color:#455a64}.form-group-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}label[_ngcontent-%COMP%]{font-size:14px;color:#666;display:block;margin-bottom:4px;margin-top:12px}input[type=email][_ngcontent-%COMP%], input[type=text][_ngcontent-%COMP%], input[type=password][_ngcontent-%COMP%]{width:100%;padding:12px;background:#f1f6ff;border:1px solid #dbe6f3;border-radius:4px;font-size:14px;margin-bottom:6px}.error[_ngcontent-%COMP%]{color:red;font-size:12px;margin-top:-6px;margin-bottom:8px}.row-options[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin:12px 0 20px}.row-options[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{font-size:13px;color:#444}.row-options[_ngcontent-%COMP%]   .forgot-link[_ngcontent-%COMP%]{font-size:13px;color:#2979ff;text-decoration:none}.row-options[_ngcontent-%COMP%]   .forgot-link[_ngcontent-%COMP%]:hover{text-decoration:underline}button[_ngcontent-%COMP%]{padding:12px;background-color:#5c4dc5;color:#fff;font-size:15px;font-weight:500;border:none;border-radius:6px;cursor:pointer;box-shadow:0 2px 4px #5c4dc533;transition:background .3s ease}button[_ngcontent-%COMP%]:hover{background-color:#493cb3}button[_ngcontent-%COMP%]:disabled{background-color:gray;cursor:not-allowed}.back-link[_ngcontent-%COMP%]{margin-top:30px;text-align:center}.back-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:14px;text-decoration:none;color:#1976d2}.back-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{margin-right:5px}.back-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.submit[_ngcontent-%COMP%]{margin-top:20px}"]})};var ee=[{path:"",redirectTo:"sign-in",pathMatch:"full"},{path:"sign-in",component:v},{path:"admin",loadChildren:()=>import("./chunk-4YL66SZU.js").then(t=>t.AdminRoutes)},{path:"error",component:Y},{path:"loading",component:Z},{path:"upload-image",component:$},{path:"warning",component:K},{path:"**",redirectTo:"sign-in"}];var te={providers:[M(),k({eventCoalescing:!0}),H(ee),T(),P(L),{provide:F,useClass:C,multi:!0}]};var _=class t{constructor(n){this._authenticationService=n}ngOnInit(){this._authenticationService.handleUserAuthentication()}static \u0275fac=function(e){return new(e||t)(c(d))};static \u0275cmp=g({type:t,selectors:[["app-root"]],decls:1,vars:0,template:function(e,o){e&1&&m(0,"router-outlet")},dependencies:[D],encapsulation:2})};A(_,te).catch(t=>console.error(t));
