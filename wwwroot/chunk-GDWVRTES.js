import{A as W,b as A,d as I,e as N,f as T,g as C,h as _,i as D,k as P,n as k,p as U,q as J,s as K,t as Q,v as w}from"./chunk-L7HYSWOG.js";import{g as O,i as X,j as Z}from"./chunk-SMNPRYKW.js";import"./chunk-LCCYGYQT.js";import{Aa as c,Ba as p,Bb as x,Ca as z,Da as B,Ea as Y,Fa as l,Ga as t,Ha as i,Ia as S,O as v,Oa as j,P as h,Pb as F,Qa as g,Qb as L,Sa as m,Tb as R,Ub as y,ab as a,bb as H,cb as f,eb as q,gb as $,ha as s,la as u,oa as E,u as G}from"./chunk-M53X7M2I.js";var ae=["class","component"],se=()=>[10,20,30,50];function de(o,r){o&1&&(t(0,"div",10),S(1,"app-loading-page"),i())}function le(o,r){if(o&1&&(t(0,"div",11),S(1,"app-error-page",14),i()),o&2){let e=m();s(),l("errorData",e.errorData)}}function me(o,r){if(o&1){let e=j();t(0,"tr")(1,"td"),a(2),i(),t(3,"td"),a(4),i(),t(5,"td")(6,"button",16),g("click",function(){let d=v(e).$implicit,V=m(2);return h(V.getSessionStudentDetails(d.name))}),a(7,"Student List"),i()()()}if(o&2){let e=r.$implicit,n=r.$index;s(2),H(n+1),s(2),H(e.name)}}function ce(o,r){if(o&1&&(t(0,"div",12)(1,"table",15)(2,"thead")(3,"tr")(4,"th"),a(5,"Sl.No"),i(),t(6,"th"),a(7,"Academic Year Starts"),i(),t(8,"th"),a(9,"Actions"),i()()(),t(10,"tbody"),B(11,me,8,2,"tr",null,z),i()()()),o&2){let e=m();s(11),Y(e.sessions)}}function pe(o,r){if(o&1&&(t(0,"option",19),a(1),i()),o&2){let e=r.$implicit;l("value",e),s(),f(" ",e," ")}}function ue(o,r){if(o&1){let e=j();t(0,"div",13)(1,"div",17)(2,"label"),a(3,"Items per page:"),i(),t(4,"select",18),g("change",function(d){v(e);let V=m();return h(V.onPageSizeChange(d))}),B(5,pe,2,2,"option",19,z),i(),t(7,"span"),a(8),i(),t(9,"button",20),g("click",function(){v(e);let d=m();return h(d.goToFirstPage())}),a(10," \xAB "),i(),t(11,"button",20),g("click",function(){v(e);let d=m();return h(d.goToPreviousPage())}),a(12," \u2039 "),i(),t(13,"button",20),g("click",function(){v(e);let d=m();return h(d.goToNextPage())}),a(14," \u203A "),i(),t(15,"button",20),g("click",function(){v(e);let d=m();return h(d.goToLastPage())}),a(16," \xBB "),i()()()}if(o&2){let e=m();s(4),l("value",e.pageSize),s(),Y($(8,se)),s(3),q("",e.pageNumber*e.pageSize+1," - ",e.getEndItemIndex()," of ",e.totalRecords),s(),l("disabled",e.pageNumber===0),s(2),l("disabled",e.pageNumber===0),s(2),l("disabled",e.pageNumber+1>=e.totalPages),s(2),l("disabled",e.pageNumber+1>=e.totalPages)}}var M=class o{constructor(r,e,n){this._studentService=r;this._authService=e;this._router=n}paginatorForm=new C({pageNumber:new _(0),pageSize:new _(10)});filterForm=new C({searchString:new _(null)});isLoading=!1;isLoadingData=!0;isError=!1;errorData;totalRecords=0;sessions=[];ngOnInit(){this.getRoutesData(),this.paginatorForm.valueChanges.pipe(G(500)).subscribe(r=>{this.isLoadingData=!0,this.getRoutesData()}),this.filterForm.valueChanges.pipe(G(500)).subscribe(r=>{this.isLoadingData=!0,this.getRoutesData()})}get pageNumber(){return this.paginatorForm.get("pageNumber")?.value??0}get pageSize(){return this.paginatorForm.get("pageSize")?.value??10}get totalPages(){return Math.ceil(this.totalRecords/this.pageSize)}getEndItemIndex(){let r=(this.pageNumber+1)*this.pageSize;return r>this.totalRecords?this.totalRecords:r}goToFirstPage(){this.paginatorForm.patchValue({pageNumber:0})}goToPreviousPage(){this.pageNumber>0&&this.paginatorForm.patchValue({pageNumber:this.pageNumber-1})}goToNextPage(){this.pageNumber+1<this.totalPages&&this.paginatorForm.patchValue({pageNumber:this.pageNumber+1})}goToLastPage(){this.paginatorForm.patchValue({pageNumber:this.totalPages-1})}onPageSizeChange(r){let e=parseInt(r.target.value,10);this.paginatorForm.patchValue({pageSize:e,pageNumber:0})}getRoutesData(){let r={pageIndex:this.pageNumber,pageSize:this.pageSize,searchString:this.filterForm.value.searchString||""};this.isError=!1,this.errorData=null,this.isLoadingData=!0,this._studentService.apiStudentGetSessionsPost(r).subscribe({next:e=>{this.isLoadingData=!1,e.statusCode===200&&e.data?(this.isError=!1,this.sessions=e.data,this.totalRecords=e.totalRecords??0):(this.isError=!0,this.errorData={imgSrc:"empty-box.png",errorTitleMessage:"No Data available",errorSubTitleMessage:"Please try to add Sessions!"})},error:e=>{this.isLoadingData=!1,this.sessions=[],navigator.onLine?e.status===401?this._authService.logout():this.setGenericError():this.errorData={imgSrc:"no-signal.png",errorTitleMessage:"Internet connection lost",errorSubTitleMessage:"Please check your connection."},this.isError=!0}})}setGenericError(){this.errorData={imgSrc:"error.png",errorTitleMessage:"Something went wrong",errorSubTitleMessage:"Please try again later"}}resetToSearch(){this.filterForm.controls.searchString.reset()}getSessionStudentDetails(r){this._router.navigate(["/admin/students/list"],{queryParams:{session:r}})}static \u0275fac=function(e){return new(e||o)(u(O),u(y),u(F))};static \u0275cmp=E({type:o,selectors:[["app-list",8,"component"]],attrs:ae,decls:22,vars:5,consts:[[1,"main-container"],[1,"header"],[1,"header-left"],[1,"page-title"],[1,"breadcrumb"],["routerLink","/admin/dashboard"],[1,"separator"],[1,"header-right",3,"formGroup"],["type","text","placeholder","Search...","formControlName","searchString",1,"search-input"],["routerLink","/admin/sessions/add",1,"add-button"],["fxLayoutAlign","center center",1,"loading-page-ui"],[1,"error-page-ui"],[1,"table-wrapper"],[1,"paginator-wrapper"],[3,"errorData"],[1,"table-ui"],[1,"edit-button",3,"click"],[1,"pagination-controls"],[3,"change","value"],[3,"value"],[3,"click","disabled"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),a(5,"Academic Years"),i()(),t(6,"div",4)(7,"span")(8,"a",5),a(9,"Home"),i()(),t(10,"span",6),a(11,"/"),i(),t(12,"span"),a(13,"Academic Years"),i()()(),t(14,"form",7),S(15,"input",8),t(16,"button",9),a(17,"Add"),i()()(),c(18,de,2,0,"div",10),c(19,le,2,1,"div",11),c(20,ce,13,0,"div",12),c(21,ue,17,9,"div",13),i()),e&2&&(s(14),l("formGroup",n.filterForm),s(4),p(n.isLoadingData&&!n.isError?18:-1),s(),p(!n.isLoadingData&&n.isError?19:-1),s(),p(!n.isLoadingData&&!n.isError?20:-1),s(),p(n.totalRecords>n.pageSize?21:-1))},dependencies:[R,L,x,Z,w,D,U,J,A,N,T,P,k,X],encapsulation:2})};var ge=["class","component"];function Se(o,r){o&1&&(t(0,"span"),a(1,"Academic year is required"),i())}function ve(o,r){o&1&&(t(0,"span"),a(1,"Please enter valid academic year or current year"),i())}function he(o,r){if(o&1&&(t(0,"div",17),c(1,Se,2,0,"span"),c(2,ve,2,0,"span"),i()),o&2){let e=m();s(),p(e.addOrEditSessionForm.controls.name.errors!=null&&e.addOrEditSessionForm.controls.name.errors.required?1:-1),s(),p(!(e.addOrEditSessionForm.controls.name.errors!=null&&e.addOrEditSessionForm.controls.name.errors.required)&&(e.addOrEditSessionForm.controls.name.errors!=null&&e.addOrEditSessionForm.controls.name.errors.min||e.addOrEditSessionForm.controls.name.errors!=null&&e.addOrEditSessionForm.controls.name.errors.max)?2:-1)}}function fe(o,r){o&1&&S(0,"span",20)}var b=class o{constructor(r,e,n,d){this._studentService=r;this._router=e;this._authenticationService=n;this._snackBar=d}addOrEditSessionForm=new C({name:new _(0,[I.required,I.min(new Date().getFullYear()),I.max(new Date().getFullYear())])});isLoading=!1;sessionId;isLoadingData=!1;isError=!1;errorData;ngOnInit(){}onSubmit(){let r=this.addOrEditSessionForm.value;if(!this.sessionId)if(this.addOrEditSessionForm.valid){let e={name:r.name?.toString()??""};this.isLoading=!0,this.addOrEditSessionForm.disable(),this._studentService.apiStudentAddSessionPost(e).subscribe({next:n=>{this.isLoading=!1,this.addOrEditSessionForm.enable(),n.statusCode===200?(this._router.navigateByUrl("/admin/sessions/list"),this._snackBar.open(n.message??"Academic year created successfully","Close",{duration:3e3,panelClass:["snack-success"]})):this._snackBar.open(n.message??"Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]})},error:n=>{this.isLoading=!1,this.addOrEditSessionForm.enable(),navigator.onLine?this._snackBar.open("Something went wrong, Please try after sometime","Close",{duration:3e3,panelClass:["snack-error"]}):n.status==401?this._authenticationService.logout():this._snackBar.open("Internet Connection Lost, Please check your connectivity","Close",{duration:3e3,panelClass:["snack-error"]})}})}else{this._snackBar.open("Please enter academic year","Close",{duration:3e3,panelClass:["snack-error"]}),this.addOrEditSessionForm.markAllAsTouched();return}}static \u0275fac=function(e){return new(e||o)(u(O),u(F),u(y),u(W))};static \u0275cmp=E({type:o,selectors:[["app-add-or-edit",8,"component"]],attrs:ge,decls:36,vars:7,consts:[[1,"main-container"],[1,"header"],[1,"header-left"],[1,"page-title"],[1,"breadcrumb"],["routerLink","/admin/dashboard"],[1,"separator"],["routerLink","/admin/sessions/list"],[1,"form-container"],[3,"ngSubmit","formGroup"],[1,"form-body"],[1,"basic-container"],[1,"form-row"],[1,"form-group"],["for","name"],[1,"text-warn"],["type","tel","formControlName","name","id","name","oninput","this.value = this.value.replace(/[^0-9]/g, '');","maxlength","4","minlength","4","autocomplete","off","aria-label","Academic Year"],[1,"error"],[1,"form-actions"],["type","submit",1,"submit",3,"disabled"],[1,"spinner"]],template:function(e,n){e&1&&(t(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),a(5),i()(),t(6,"div",4)(7,"span")(8,"a",5),a(9,"Home"),i()(),t(10,"span",6),a(11,"/"),i(),t(12,"span")(13,"a",7),a(14,"Academic Years"),i()(),t(15,"span",6),a(16,"/"),i(),t(17,"span"),a(18),i()()()(),t(19,"div",8)(20,"form",9),g("ngSubmit",function(){return n.onSubmit()}),t(21,"div",10)(22,"div",11)(23,"div",12)(24,"div",13)(25,"label",14),a(26,"Academic Year"),t(27,"span",15),a(28,"*"),i()(),S(29,"input",16),c(30,he,3,2,"div",17),i(),S(31,"div",13),i()()(),t(32,"div",18)(33,"button",19),c(34,fe,1,0,"span",20),a(35),i()()()()()),e&2&&(s(5),f("",n.sessionId?"Edit":"Add"," Academic Year"),s(13),f("",n.sessionId?"Edit":"Add"," Academic Year"),s(2),l("formGroup",n.addOrEditSessionForm),s(10),p(n.addOrEditSessionForm.controls.name.touched&&n.addOrEditSessionForm.controls.name.invalid?30:-1),s(3),l("disabled",n.isLoading),s(),p(n.isLoading?34:-1),s(),f(" ",n.isLoading?"Submitting...":"Submit"," "))},dependencies:[R,L,w,D,A,N,T,K,Q,P,k,x],encapsulation:2})};var Oe=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:M},{path:"add",component:b},{path:"edit",component:b}];export{Oe as sessionsRoutes};
